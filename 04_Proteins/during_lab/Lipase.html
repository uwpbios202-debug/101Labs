<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lipase Enzyme Experiment: Temperature Effects</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* UWP Color Scheme - Based on the style guide */
        :root {
            --uwp-primary: #002F6C; /* Primary Blue */
            --uwp-secondary: #BA0C2F; /* Cardinal Red */
            --uwp-accent: #006C45; /* Forest Green */
            --uwp-light: #F2F2F2; /* Light Gray */
            --uwp-dark: #333333; /* Dark Gray */
            --uwp-highlight: #FFC72C; /* Gold */
            --uwp-white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--uwp-light);
            color: var(--uwp-dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(135deg, var(--uwp-primary) 0%, #004494 100%);
            color: var(--uwp-white);
            padding: 2rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            margin-bottom: 30px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-icon {
            background-color: var(--uwp-highlight);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: var(--uwp-primary);
        }

        .logo-text h1 {
            font-size: 2.2rem;
            margin-bottom: 5px;
        }

        .logo-text p {
            opacity: 0.9;
            font-size: 1rem;
        }

        /* Main Layout */
        .experiment-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .main-content {
            background-color: var(--uwp-white);
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            padding: 30px;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .sidebar-section {
            background-color: var(--uwp-white);
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            padding: 25px;
        }

        /* Typography */
        h2 {
            color: var(--uwp-primary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--uwp-highlight);
            font-size: 1.8rem;
        }

        h3 {
            color: var(--uwp-secondary);
            margin: 20px 0 15px;
            font-size: 1.4rem;
        }

        h4 {
            color: var(--uwp-accent);
            margin: 15px 0 10px;
        }

        /* Sections */
        .section {
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eee;
        }

        .section:last-child {
            border-bottom: none;
        }

        /* Theory Box */
        .theory-box {
            background-color: #f0f7ff;
            border-left: 6px solid var(--uwp-primary);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }

        .theory-box h4 {
            color: var(--uwp-primary);
            margin-top: 0;
        }

        /* Procedure Steps */
        .procedure-steps {
            counter-reset: step-counter;
        }

        .step {
            margin-bottom: 20px;
            padding-left: 50px;
            position: relative;
        }

        .step:before {
            counter-increment: step-counter;
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background-color: var(--uwp-accent);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* Temperature Indicators */
        .temp-indicator {
            display: inline-block;
            padding: 8px 16px;
            margin: 5px 10px 5px 0;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1rem;
        }

        .temp-0 {
            background-color: #d1ecff;
            border: 2px solid #0d8bf2;
            color: #0056a3;
        }

        .temp-21 {
            background-color: #d4f7d4;
            border: 2px solid #28a745;
            color: #1e7e34;
        }

        .temp-100 {
            background-color: #ffe0e0;
            border: 2px solid #dc3545;
            color: #a71d2a;
        }

        /* Data Collection */
        .data-collection {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .data-table th {
            background-color: var(--uwp-primary);
            color: white;
            font-weight: 600;
            padding: 15px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .data-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
            background-color: white;
        }

        .time-cell {
            background-color: #f0f0f0;
            font-weight: 600;
        }

        .plus-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 6px;
            text-align: center;
            font-weight: bold;
            transition: border-color 0.3s;
        }

        .plus-input:focus {
            border-color: var(--uwp-accent);
            outline: none;
        }

        /* Graph Container */
        .graph-container {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin: 30px 0;
        }

        .chart-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .chart-btn {
            background-color: var(--uwp-primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }

        .chart-btn:hover {
            background-color: #00204d;
        }

        .chart-btn.secondary {
            background-color: var(--uwp-accent);
        }

        .chart-btn.secondary:hover {
            background-color: #005630;
        }

        #reactionChart {
            max-height: 500px;
            margin-top: 20px;
        }

        /* Questions */
        .question-box {
            background-color: #f8f9fa;
            border-left: 5px solid var(--uwp-secondary);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }

        .question {
            margin-bottom: 15px;
            font-weight: 600;
        }

        .answer-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .answer-input:focus {
            border-color: var(--uwp-accent);
            outline: none;
        }

        .feedback {
            padding: 10px;
            margin-top: 10px;
            border-radius: 6px;
            display: none;
        }

        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .check-answer {
            background-color: var(--uwp-secondary);
            color: white;
            border: none;
            padding: 8px 18px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
            transition: background-color 0.3s;
        }

        .check-answer:hover {
            background-color: #9a0b26;
        }

        /* Key Concepts - UPDATED WITH CLICKABLE CARDS */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .concept-card {
            background-color: #f0f9ff;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #c6e2ff;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .concept-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--uwp-highlight);
        }

        .concept-card h5 {
            color: var(--uwp-primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .info-icon {
            color: var(--uwp-accent);
            font-size: 1.1rem;
            opacity: 0.7;
        }

        .concept-card:hover .info-icon {
            opacity: 1;
        }

        /* Simple Modal Styles */
        .simple-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-box {
            background-color: white;
            width: 90%;
            max-width: 600px;
            border-radius: 10px;
            padding: 25px;
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--uwp-secondary);
            transition: color 0.3s;
        }

        .close-btn:hover {
            color: var(--uwp-primary);
        }

        /* Footer */
        footer {
            background-color: var(--uwp-dark);
            color: var(--uwp-white);
            padding: 30px 0;
            margin-top: 50px;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer-logo {
            font-size: 2rem;
            color: var(--uwp-highlight);
            margin-bottom: 15px;
        }

        .copyright {
            opacity: 0.8;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .experiment-container {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .concept-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-temperature-high"></i>
                </div>
                <div class="logo-text">
                    <h1>Lipase Enzyme Experiment</h1>
                    <p>Effect of Temperature on Lipid Hydrolysis</p>
                </div>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 1.1rem; margin-bottom: 5px;">Biology Laboratory</div>
                <div style="opacity: 0.9;">UWP Style Guide Compliant</div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="experiment-container">
            <div class="main-content">
                <!-- Introduction Section -->
                <section class="section">
                    <h2><i class="fas fa-flask"></i> Experiment Overview</h2>
                    
                    <div class="theory-box">
                        <h4><i class="fas fa-lightbulb"></i> Key Concept: Enzyme Kinetics</h4>
                        <p>Lipase is an enzyme that catalyzes the hydrolysis of triglycerides into glycerol and fatty acids. In this experiment, you'll investigate how temperature affects the rate of this enzymatic reaction using a pH indicator that changes color as fatty acids are released.</p>
                        <p><strong>Chemical Reaction:</strong> Triglyceride + 3H₂O → Glycerol + 3 Fatty Acids</p>
                    </div>
                    
                    <h3>Temperature Conditions</h3>
                    <div>
                        <span class="temp-indicator temp-0"><i class="fas fa-snowflake"></i> 0°C (Ice Bath)</span>
                        <span class="temp-indicator temp-21"><i class="fas fa-thermometer-half"></i> 21°C (Room Temp)</span>
                        <span class="temp-indicator temp-100"><i class="fas fa-fire"></i> 100°C (Boiling)</span>
                        <span class="temp-indicator" style="background-color:#e8d4ff; border-color:#9b59b6; color:#6c3483;">
                            <i class="fas fa-ban"></i> 21°C with Inhibitor
                        </span>
                    </div>
                    
                    <p style="margin-top: 15px;">Each temperature condition will affect the enzyme's activity differently. You'll measure the reaction progress by observing color changes from blue (basic pH) to yellow (acidic pH) as fatty acids are produced.</p>
                </section>
                
                <!-- Procedure Section -->
                <section class="section">
                    <h2><i class="fas fa-list-ol"></i> Experimental Procedure</h2>
                    
                    <div class="procedure-steps">
                        <div class="step">
                            <strong>Prepare Water Baths:</strong> Set up three beakers: one ice bath (0°C), two at room temperature (21°C). Instructor will prepare 100°C water bath.
                        </div>
                        
                        <div class="step">
                            <strong>Label Test Tubes:</strong> Label three tubes 1-3 and three tubes with 'E' for enzyme.
                        </div>
                        
                        <div class="step">
                            <strong>Add Solutions:</strong> To tubes 1-3, add 4 mL milk solution + 2 mL alkaline solution. To tube 3 ONLY, add 1 mL Orlistat inhibitor.
                        </div>
                        
                        <div class="step">
                            <strong>Add Enzyme:</strong> Add 2 mL lipase solution to each 'E' tube.
                        </div>
                        
                        <div class="step">
                            <strong>Temperature Equilibration:</strong> Place tubes in respective water baths for 10 minutes.
                        </div>
                        
                        <div class="step">
                            <strong>Initiate Reaction:</strong> At Time 0, pour enzyme solution into corresponding numbered tube. Record time and mix.
                        </div>
                        
                        <div class="step">
                            <strong>Data Collection:</strong> Every 5 minutes for 30 minutes, record color intensity using "+" system.
                        </div>
                    </div>
                </section>
                
                <!-- Data Collection Section -->
                <section class="section">
                    <h2><i class="fas fa-clipboard-list"></i> Data Collection</h2>
                    
                    <div class="data-collection">
                        <p>Record the intensity of yellow color using the "+" system:</p>
                        <ul style="margin-left: 20px; margin-bottom: 15px;">
                            <li><strong>0 +</strong>: Blue (no hydrolysis)</li>
                            <li><strong>1-3 +</strong>: Blue-green (low activity)</li>
                            <li><strong>4-6 +</strong>: Green-yellow (moderate activity)</li>
                            <li><strong>7-9 +</strong>: Yellow (high activity)</li>
                            <li><strong>10-12 +</strong>: Bright yellow (maximum hydrolysis)</li>
                        </ul>
                        
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Time (min)</th>
                                    <th>100°C<br><small>Instructor Demo</small></th>
                                    <th>0°C<br><small>Ice Bath</small></th>
                                    <th>21°C<br><small>Room Temp</small></th>
                                    <th>21°C with Inhibitor</th>
                                </tr>
                            </thead>
                            <tbody id="dataTableBody">
                                <!-- Rows will be generated by JavaScript -->
                            </tbody>
                        </table>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="chart-btn" onclick="generateSampleData()">
                                <i class="fas fa-vial"></i> Load Sample Data
                            </button>
                            <button class="chart-btn secondary" onclick="clearData()">
                                <i class="fas fa-eraser"></i> Clear Data
                            </button>
                            <button class="chart-btn" onclick="saveData()" style="background-color: var(--uwp-accent);">
                                <i class="fas fa-save"></i> Save Data
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- Data Analysis & Graphing -->
                <section class="section">
                    <h2><i class="fas fa-chart-line"></i> Data Analysis</h2>
                    
                    <div class="graph-container">
                        <p>Visualize your data to compare enzyme activity across different temperatures. The graph will plot the "+" score (representing hydrolysis progress) against time for each condition.</p>
                        
                        <div class="chart-controls">
                            <button class="chart-btn" onclick="plotLineGraph()">
                                <i class="fas fa-chart-line"></i> Plot Line Graph
                            </button>
                            <button class="chart-btn secondary" onclick="plotBarChart()">
                                <i class="fas fa-chart-bar"></i> Plot Bar Chart (Final Time)
                            </button>
                            <button class="chart-btn" onclick="calculateReactionRates()" style="background-color: var(--uwp-secondary);">
                                <i class="fas fa-calculator"></i> Calculate Reaction Rates
                            </button>
                        </div>
                        
                        <div style="height: 400px;">
                            <canvas id="reactionChart"></canvas>
                        </div>
                        
                        <div id="rateCalculation" style="margin-top: 25px; padding: 15px; background-color: #f0f9ff; border-radius: 8px; display: none;">
                            <h4><i class="fas fa-calculator"></i> Reaction Rate Analysis</h4>
                            <div id="rateResults"></div>
                        </div>
                    </div>
                </section>
                
                <!-- Questions Section -->
                <section class="section">
                    <h2><i class="fas fa-question-circle"></i> Analysis Questions</h2>
                    
                    <div class="question-box">
                        <div class="question">1. Which water bath temperature is closest to where lipase normally functions in the human body?</div>
                        <select class="answer-input" id="q1">
                            <option value="">Select an option</option>
                            <option value="100">100°C</option>
                            <option value="21">21°C</option>
                            <option value="0">0°C</option>
                        </select>
                        <button class="check-answer" onclick="checkAnswer(1)">Check Answer</button>
                        <div class="feedback" id="feedback1"></div>
                    </div>
                    
                    <div class="question-box">
                        <div class="question">2. What is the specific substrate for lipase?</div>
                        <input type="text" class="answer-input" id="q2" placeholder="Enter substrate name">
                        <button class="check-answer" onclick="checkAnswer(2)">Check Answer</button>
                        <div class="feedback" id="feedback2"></div>
                    </div>
                    
                    <div class="question-box">
                        <div class="question">3. The faster the pH changes, the ______ active the enzyme is.</div>
                        <select class="answer-input" id="q3">
                            <option value="">Select an option</option>
                            <option value="more">More</option>
                            <option value="less">Less</option>
                        </select>
                        <button class="check-answer" onclick="checkAnswer(3)">Check Answer</button>
                        <div class="feedback" id="feedback3"></div>
                    </div>
                    
                    <div class="question-box">
                        <div class="question">5. Compare the results from ice bath (0°C) to boiling water bath (100°C). Was lipase denatured at 100°C? At 0°C?</div>
                        <textarea class="answer-input" id="q5" rows="4" placeholder="Enter your analysis here..."></textarea>
                        <button class="check-answer" onclick="checkAnswer(5)">Check Answer</button>
                        <div class="feedback" id="feedback5"></div>
                    </div>
                    
                    <div class="question-box">
                        <div class="question">6. Based on your results, what is the optimum temperature for lipase activity?</div>
                        <input type="text" class="answer-input" id="q6" placeholder="Enter temperature">
                        <button class="check-answer" onclick="checkAnswer(6)">Check Answer</button>
                        <div class="feedback" id="feedback6"></div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 25px;">
                        <button class="chart-btn" onclick="checkAllAnswers()" style="padding: 12px 30px; font-size: 1.1rem;">
                            <i class="fas fa-check-double"></i> Check All Answers
                        </button>
                    </div>
                </section>
            </div>
            
            <!-- Sidebar - UPDATED WITH CLICKABLE CARDS -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <h3><i class="fas fa-key"></i> Key Concepts (Click for Details)</h3>
                    <div class="concept-grid">
                        <div class="concept-card" onclick="showSimpleModal('enzyme')">
                            <h5>Enzyme <span class="info-icon"><i class="fas fa-info-circle"></i></span></h5>
                            <p>Biological catalyst that speeds up chemical reactions</p>
                        </div>
                        
                        <div class="concept-card" onclick="showSimpleModal('hydrolysis')">
                            <h5>Hydrolysis <span class="info-icon"><i class="fas fa-info-circle"></i></span></h5>
                            <p>Breaking chemical bonds using water</p>
                        </div>
                        
                        <div class="concept-card" onclick="showSimpleModal('optimum')">
                            <h5>Optimum Temperature <span class="info-icon"><i class="fas fa-info-circle"></i></span></h5>
                            <p>Temperature at which enzyme works fastest</p>
                        </div>
                        
                        <div class="concept-card" onclick="showSimpleModal('denaturation')">
                            <h5>Denaturation <span class="info-icon"><i class="fas fa-info-circle"></i></span></h5>
                            <p>Loss of enzyme structure due to extreme conditions</p>
                        </div>
                    </div>
                    
                    <!-- Hydrolysis Image Link -->
                    <div style="margin-top: 25px; text-align: center;">
                        <h5><i class="fas fa-image"></i> Hydrolysis Diagram</h5>
                        <a href="images/hydrolysis.jpg" target="_blank" style="display: inline-block; margin-top: 10px; padding: 10px 20px; background-color: var(--uwp-accent); color: white; text-decoration: none; border-radius: 6px; font-weight: 600;">
                            <i class="fas fa-external-link-alt"></i> View Hydrolysis Reaction
                        </a>
                        <p style="margin-top: 10px; font-size: 0.9rem;">Opens in new tab</p>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-chart-bar"></i> Graph Interpretation</h3>
                    <p><strong>Steeper slope</strong> = Faster reaction rate</p>
                    <p><strong>Higher plateau</strong> = More complete hydrolysis</p>
                    <p><strong>Flat line</strong> = No enzyme activity</p>
                    <p><strong>Compare lines</strong> to identify optimum temperature</p>
                    
                    <div style="margin-top: 15px; padding: 15px; background-color: #f0f7ff; border-radius: 8px;">
                        <h5>Expected Results:</h5>
                        <ul style="margin-left: 20px;">
                            <li><strong>21°C</strong>: Steady increase, highest activity</li>
                            <li><strong>0°C</strong>: Slow, gradual increase</li>
                            <li><strong>100°C</strong>: Flat line (denatured enzyme)</li>
                            <li><strong>Inhibitor</strong>: Slower than 21°C alone</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-flask"></i> Experimental Variables</h3>
                    <p><strong>Independent:</strong> Temperature (0°C, 21°C, 100°C)</p>
                    <p><strong>Dependent:</strong> Enzyme activity (color change rate)</p>
                    <p><strong>Controls:</strong></p>
                    <ul style="margin-left: 20px;">
                        <li>Same enzyme concentration</li>
                        <li>Same substrate concentration</li>
                        <li>Same pH indicator</li>
                        <li>Same observation times</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Simple Modal for Concept Details -->
    <div id="simpleModal" class="simple-modal">
        <div class="modal-box">
            <span class="close-btn" onclick="closeSimpleModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <footer>
        <div class="container footer-content">
            <div class="footer-logo">
                <i class="fas fa-microscope"></i>
            </div>
            <h3>Lipase Enzyme Laboratory</h3>
            <p>Interactive experiment following UWP Style Guidelines</p>
            <p style="margin-top: 15px; opacity: 0.8;">Primary Color: #002F6C | Secondary Color: #BA0C2F | Accent: #006C45</p>
            <p style="opacity: 0.7; margin-top: 10px;">© 2023 Biology Department | Data Analysis & Graphing Enabled</p>
        </div>
    </footer>

    <script>
        // Initialize Chart.js
        let reactionChart;
        let ctx = document.getElementById('reactionChart').getContext('2d');
        
        // Data storage
        let experimentData = {
            times: [0, 5, 10, 15, 20, 25, 30],
            temp100: [0, 0, 0, 0, 0, 0, 0],
            temp0: [0, 0, 0, 0, 0, 0, 0],
            temp21: [0, 0, 0, 0, 0, 0, 0],
            temp21Inhibitor: [0, 0, 0, 0, 0, 0, 0]
        };
        
        // Initialize data table
        function initializeDataTable() {
            const tableBody = document.getElementById('dataTableBody');
            tableBody.innerHTML = '';
            
            for (let i = 0; i < experimentData.times.length; i++) {
                const row = document.createElement('tr');
                
                // Time cell
                const timeCell = document.createElement('td');
                timeCell.className = 'time-cell';
                timeCell.textContent = experimentData.times[i] + ' min';
                row.appendChild(timeCell);
                
                // Create input cells for each condition
                createInputCell(row, 'temp100', i);
                createInputCell(row, 'temp0', i);
                createInputCell(row, 'temp21', i);
                createInputCell(row, 'temp21Inhibitor', i);
                
                tableBody.appendChild(row);
            }
        }
        
        function createInputCell(row, dataKey, index) {
            const cell = document.createElement('td');
            const input = document.createElement('input');
            input.type = 'number';
            input.className = 'plus-input';
            input.min = 0;
            input.max = 12;
            input.value = experimentData[dataKey][index];
            input.dataset.key = dataKey;
            input.dataset.index = index;
            
            input.addEventListener('change', function() {
                const key = this.dataset.key;
                const idx = parseInt(this.dataset.index);
                const value = parseInt(this.value) || 0;
                
                // Ensure value is within range
                if (value < 0) this.value = 0;
                if (value > 12) this.value = 12;
                
                experimentData[key][idx] = parseInt(this.value) || 0;
            });
            
            cell.appendChild(input);
            row.appendChild(cell);
        }
        
        // Generate sample data for demonstration
        function generateSampleData() {
            // Sample data based on expected results
            experimentData.temp100 = [0, 0, 0, 0, 0, 0, 0]; // No activity at 100°C (denatured)
            experimentData.temp0 = [0, 1, 2, 3, 4, 5, 6]; // Slow activity at 0°C
            experimentData.temp21 = [0, 3, 6, 8, 10, 11, 12]; // Optimal activity at 21°C
            experimentData.temp21Inhibitor = [0, 1, 2, 3, 4, 5, 6]; // Inhibitor reduces activity
            
            initializeDataTable();
            plotLineGraph();
            
            // Show notification
            alert("Sample data loaded! This represents expected experimental results. You can modify the values in the table.");
        }
        
        // Clear all data
        function clearData() {
            if (confirm("Are you sure you want to clear all data?")) {
                experimentData.temp100 = [0, 0, 0, 0, 0, 0, 0];
                experimentData.temp0 = [0, 0, 0, 0, 0, 0, 0];
                experimentData.temp21 = [0, 0, 0, 0, 0, 0, 0];
                experimentData.temp21Inhibitor = [0, 0, 0, 0, 0, 0, 0];
                
                initializeDataTable();
                
                if (reactionChart) {
                    reactionChart.destroy();
                }
                
                document.getElementById('rateCalculation').style.display = 'none';
            }
        }
        
        // Save data locally
        function saveData() {
            localStorage.setItem('lipaseExperimentData', JSON.stringify(experimentData));
            alert('Data saved to browser storage!');
        }
        
        // Load saved data
        function loadSavedData() {
            const savedData = localStorage.getItem('lipaseExperimentData');
            if (savedData) {
                experimentData = JSON.parse(savedData);
                initializeDataTable();
            }
        }
        
        // Plot line graph
        function plotLineGraph() {
            if (reactionChart) {
                reactionChart.destroy();
            }
            
            reactionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: experimentData.times.map(t => t + ' min'),
                    datasets: [
                        {
                            label: '100°C (Boiling)',
                            data: experimentData.temp100,
                            borderColor: '#dc3545',
                            backgroundColor: 'rgba(220, 53, 69, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: '0°C (Ice Bath)',
                            data: experimentData.temp0,
                            borderColor: '#0d8bf2',
                            backgroundColor: 'rgba(13, 139, 242, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: '21°C (Room Temp)',
                            data: experimentData.temp21,
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: '21°C with Inhibitor',
                            data: experimentData.temp21Inhibitor,
                            borderColor: '#9b59b6',
                            backgroundColor: 'rgba(155, 89, 182, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Hydrolysis Progress ("+" Score)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            max: 12
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Time (minutes)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Effect of Temperature on Lipase Activity',
                            font: {
                                size: 18
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    }
                }
            });
        }
        
        // Plot bar chart for final time point
        function plotBarChart() {
            if (reactionChart) {
                reactionChart.destroy();
            }
            
            // Get final values
            const finalValues = [
                experimentData.temp100[6],
                experimentData.temp0[6],
                experimentData.temp21[6],
                experimentData.temp21Inhibitor[6]
            ];
            
            reactionChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['100°C (Boiling)', '0°C (Ice Bath)', '21°C (Room Temp)', '21°C with Inhibitor'],
                    datasets: [{
                        label: 'Final Hydrolysis at 30 min',
                        data: finalValues,
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.7)',
                            'rgba(13, 139, 242, 0.7)',
                            'rgba(40, 167, 69, 0.7)',
                            'rgba(155, 89, 182, 0.7)'
                        ],
                        borderColor: [
                            '#dc3545',
                            '#0d8bf2',
                            '#28a745',
                            '#9b59b6'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Hydrolysis Progress ("+" Score)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            max: 12
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Final Hydrolysis Comparison at 30 Minutes',
                            font: {
                                size: 18
                            }
                        }
                    }
                }
            });
        }
        
        // Calculate reaction rates
        function calculateReactionRates() {
            const rateDiv = document.getElementById('rateResults');
            const rateContainer = document.getElementById('rateCalculation');
            
            // Calculate average rate of change (slope) for each condition
            const rates = {
                temp100: calculateSlope(experimentData.temp100),
                temp0: calculateSlope(experimentData.temp0),
                temp21: calculateSlope(experimentData.temp21),
                temp21Inhibitor: calculateSlope(experimentData.temp21Inhibitor)
            };
            
            // Find optimum temperature
            const rateValues = [rates.temp100, rates.temp0, rates.temp21, rates.temp21Inhibitor];
            const maxRate = Math.max(...rateValues);
            
            let optimumTemp = '';
            if (maxRate === rates.temp21) optimumTemp = '21°C';
            else if (maxRate === rates.temp0) optimumTemp = '0°C';
            else if (maxRate === rates.temp100) optimumTemp = '100°C';
            else optimumTemp = '21°C with Inhibitor';
            
            // Display results
            rateDiv.innerHTML = `
                <h5>Reaction Rates (change in "+" score per minute):</h5>
                <table style="width:100%; margin:10px 0; border-collapse:collapse;">
                    <tr style="background-color:#e3f2fd;">
                        <td style="padding:8px; border:1px solid #bbdefb;"><strong>100°C (Boiling)</strong></td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp100.toFixed(2)}</td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp100 === 0 ? 'No activity (denatured)' : 'Low activity'}</td>
                    </tr>
                    <tr>
                        <td style="padding:8px; border:1px solid #bbdefb;"><strong>0°C (Ice Bath)</strong></td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp0.toFixed(2)}</td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp0 < 0.2 ? 'Very slow' : 'Slow activity'}</td>
                    </tr>
                    <tr style="background-color:#e3f2fd;">
                        <td style="padding:8px; border:1px solid #bbdefb;"><strong>21°C (Room Temp)</strong></td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp21.toFixed(2)}</td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp21 > 0.3 ? 'Optimal activity' : 'Moderate activity'}</td>
                    </tr>
                    <tr>
                        <td style="padding:8px; border:1px solid #bbdefb;"><strong>21°C with Inhibitor</strong></td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp21Inhibitor.toFixed(2)}</td>
                        <td style="padding:8px; border:1px solid #bbdefb;">${rates.temp21Inhibitor < rates.temp21 ? 'Inhibited activity' : 'Similar to 21°C'}</td>
                    </tr>
                </table>
                <p><strong>Optimum Temperature:</strong> ${optimumTemp} (highest rate: ${maxRate.toFixed(2)} per minute)</p>
                <p><strong>Conclusion:</strong> Based on reaction rates, enzyme activity is highest at ${optimumTemp}. The inhibitor reduces activity at 21°C by approximately ${((1 - rates.temp21Inhibitor/rates.temp21)*100).toFixed(0)}%.</p>
            `;
            
            rateContainer.style.display = 'block';
        }
        
        function calculateSlope(data) {
            // Simple linear regression slope calculation
            const n = data.length;
            let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;
            
            for (let i = 0; i < n; i++) {
                sumX += i * 5; // Time in minutes
                sumY += data[i];
                sumXY += (i * 5) * data[i];
                sumX2 += (i * 5) * (i * 5);
            }
            
            const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            return slope || 0;
        }
        
        // Answer checking functions
        function checkAnswer(questionNum) {
            const feedback = document.getElementById(`feedback${questionNum}`);
            let isCorrect = false;
            let correctAnswer = '';
            let userAnswer = '';
            
            switch(questionNum) {
                case 1:
                    userAnswer = document.getElementById('q1').value;
                    correctAnswer = '21';
                    isCorrect = userAnswer === correctAnswer;
                    break;
                case 2:
                    userAnswer = document.getElementById('q2').value.toLowerCase().trim();
                    correctAnswer = 'triglycerides';
                    isCorrect = userAnswer === 'triglycerides' || userAnswer === 'lipids';
                    break;
                case 3:
                    userAnswer = document.getElementById('q3').value;
                    correctAnswer = 'more';
                    isCorrect = userAnswer === correctAnswer;
                    break;
                case 5:
                    userAnswer = document.getElementById('q5').value.toLowerCase();
                    // Check for key concepts
                    const hasIce = userAnswer.includes('0') || userAnswer.includes('ice') || userAnswer.includes('cold');
                    const hasBoil = userAnswer.includes('100') || userAnswer.includes('boil') || userAnswer.includes('hot');
                    const hasDenatured = userAnswer.includes('denatur');
                    const hasSlow = userAnswer.includes('slow') || userAnswer.includes('low') || userAnswer.includes('reduced');
                    
                    isCorrect = hasIce && hasBoil && hasDenatured;
                    correctAnswer = 'At 0°C, enzyme activity is slow but not denatured. At 100°C, the enzyme is denatured (permanent structural change).';
                    break;
                case 6:
                    userAnswer = document.getElementById('q6').value;
                    // Check if answer contains 21 or room temperature
                    isCorrect = userAnswer.includes('21') || 
                                userAnswer.toLowerCase().includes('room') || 
                                userAnswer.toLowerCase().includes('twenty');
                    correctAnswer = '21°C (room temperature)';
                    break;
            }
            
            feedback.textContent = isCorrect 
                ? `✓ Correct! ${correctAnswer ? 'Answer: ' + correctAnswer : ''}` 
                : `✗ Try again. ${correctAnswer ? 'Hint: ' + correctAnswer : ''}`;
            feedback.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
            feedback.style.display = 'block';
        }
        
        function checkAllAnswers() {
            for (let i = 1; i <= 8; i++) {
                if (document.getElementById(`q${i}`)) {
                    checkAnswer(i);
                }
            }
        }
        
        // NEW: Simple modal functions for concept cards
        function showSimpleModal(type) {
            const modal = document.getElementById('simpleModal');
            const content = document.getElementById('modalContent');
            
            let title = '';
            let html = '';
            
            switch(type) {
                case 'enzyme':
                    title = '<i class="fas fa-atom"></i> Enzyme Details';
                    html = `
                        <h4>What is an Enzyme?</h4>
                        <p>Enzymes are <strong>biological catalysts</strong> - proteins that speed up chemical reactions without being consumed.</p>
                        
                        <h4>Lipase Specifics</h4>
                        <p><strong>Lipase</strong> hydrolyzes triglycerides into:</p>
                        <ul>
                            <li><strong>Glycerol</strong> (the head group)</li>
                            <li><strong>Fatty acids</strong> (3 molecules per triglyceride)</li>
                        </ul>
                        
                        <p><strong>Reaction:</strong> Triglyceride + 3H₂O → Glycerol + 3 Fatty Acids</p>
                        
                        <h4>Key Characteristics</h4>
                        <ul>
                            <li><strong>Specificity:</strong> Works on specific substrates</li>
                            <li><strong>Reusability:</strong> Not consumed in reactions</li>
                            <li><strong>Temperature sensitive:</strong> Has an optimum temperature</li>
                            <li><strong>pH sensitive:</strong> Has an optimal pH range</li>
                        </ul>
                    `;
                    break;
                    
                case 'hydrolysis':
                    title = '<i class="fas fa-tint"></i> Hydrolysis Details';
                    html = `
                        <h4>What is Hydrolysis?</h4>
                        <p><strong>Hydrolysis</strong> (from Greek: <em>hydro</em> = water, <em>lysis</em> = break) is a chemical process where water molecules break chemical bonds in larger molecules.</p>
                        
                        <h4>In Biological Systems</h4>
                        <p>In living organisms, hydrolysis is crucial for:</p>
                        <ul>
                            <li><strong>Digestion:</strong> Breaking down polymers into absorbable monomers</li>
                            <li><strong>Energy release:</strong> Breaking ATP to release energy</li>
                            <li><strong>Metabolism:</strong> Processing nutrients for energy and building blocks</li>
                        </ul>
                        
                        <div style="text-align: center; margin: 20px 0; padding: 15px; background-color: #f0f7ff; border-radius: 8px;">
                            <h5>View the Hydrolysis Diagram</h5>
                            <a href="images/hydrolysis.jpg" target="_blank" style="display: inline-block; margin: 10px 0; padding: 10px 20px; background-color: var(--uwp-primary); color: white; text-decoration: none; border-radius: 6px; font-weight: 600;">
                                <i class="fas fa-external-link-alt"></i> Open hydrolysis.jpg
                            </a>
                            <p style="font-size: 0.9rem; margin-top: 10px;">The image shows how polymers are disassembled to monomers by hydrolysis.</p>
                        </div>
                    `;
                    break;
                    
                case 'denaturation':
                    title = '<i class="fas fa-fire"></i> Denaturation Details';
                    html = `
                        <h4>What is Denaturation?</h4>
                        <p><strong>Denaturation</strong> is when a protein loses its <strong>three-dimensional structure</strong> due to external stress, leading to loss of function.</p>
                        
                        <h4>Key Distinction</h4>
                        <div style="margin: 15px 0; padding: 15px; background-color: #fff3cd; border-left: 4px solid #ffc107;">
                            <p><strong>0°C:</strong> Enzyme intact but inactive due to slow molecular motion (reversible)</p>
                            <p><strong>100°C:</strong> Enzyme structure destroyed, active site distorted (irreversible)</p>
                        </div>
                        
                        <h4>In This Experiment</h4>
                        <p>At <strong>100°C</strong>, lipase is <strong>denatured</strong>:</p>
                        <ul>
                            <li>No color change observed</li>
                            <li>Permanent structural damage</li>
                        </ul>
                    `;
                    break;
                    
                case 'optimum':
                    title = '<i class="fas fa-thermometer-half"></i> Optimum Temperature Details';
                    html = `
                        <h4>What is Optimum Temperature?</h4>
                        <p>The <strong>optimum temperature</strong> is where an enzyme operates at <strong>maximum efficiency</strong>, balancing reaction rates with stability.</p>
                        
                        <h4>Finding the Optimum</h4>
                        <p>In this experiment, determine optimum temperature by:</p>
                        <ol>
                            <li>Comparing the <strong>rate of color change</strong></li>
                            <li>Identifying the <strong>fastest conversion</strong> from blue to yellow</li>
                            <li>Looking for the <strong>steepest slope</strong> on your graph</li>
                        </ol>
                        
                        <div style="margin: 15px 0; padding: 15px; background-color: #d4edda; border-left: 4px solid var(--uwp-accent);">
                            <p><strong>Graphical Interpretation:</strong><br>
                            Steeper slope = Faster reaction = Higher enzyme activity</p>
                        </div>
                    `;
                    break;
            }
            
            content.innerHTML = `
                <h3 style="color: var(--uwp-primary); margin-bottom: 20px;">${title}</h3>
                <div>${html}</div>
            `;
            
            modal.style.display = 'flex';
        }
        
        function closeSimpleModal() {
            document.getElementById('simpleModal').style.display = 'none';
        }
        
        // Close modal when clicking outside content
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('simpleModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        });
        
        // Initialize on page load
        window.onload = function() {
            initializeDataTable();
            loadSavedData();
            plotLineGraph();
        };
    </script>
</body>
</html>
