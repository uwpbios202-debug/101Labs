<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Recall Arena - Metacognition Lab</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../assets/css/style.css">
    <style>
        /* Page-specific overrides */
        .banner {
            border-left-color: var(--uwp-goldenrod);
        }
    </style>
</head>

<body>
    <nav class="bios-nav">
        <div class="bios-nav-inner">
            <a href="../index.html" class="bios-home">BIOS101</a>
            <div class="bios-menus">
                <div class="bios-menu">
                    <a href="../dashboard.html" class="bios-trigger">Metacognition Dashboard</a>
                </div>
            </div>
        </div>
    </nav>

    <header>
        <div class="shell">
            <div class="header-brand">
                <div class="header-brand-icon">03</div>
                <span>Active Recall Arena</span>
            </div>
            <div class="progress-shell">
                <div class="progress-track">
                    <div class="progress-bar" id="localProgressBar" style="width: 0%"></div>
                </div>
                <div class="progress-label" id="localProgressLabel">Phase 1 of 7</div>
            </div>
        </div>
    </header>

    <main>
        <div class="view active" id="view-experiment">
            <div class="pill-nav">
                <a href="../dashboard.html" class="btn btn-secondary">← Back to Dashboard</a>
            </div>

            <div class="banner">
                <h2>Retrieval vs. Rereading</h2>
                <p class="subline">Why recognition does not equal learning.</p>
            </div>

            <section id="phase1">
                <div class="card stack">
                    <h2>Phase 1: Observation</h2>
                    <p class="meta">Carefully read, analyze, and reflect on the following.</p>
                    
                    <div class="observation-box" id="observationBox">
                        <p>"When I study, I usually rely on rereading — sometimes over and over. It feels productive, and it makes the material seem familiar, so I convince myself I'm learning. I highlight, rewrite notes, reorganize them, and go through my textbook again thinking the repetition is helping. But when I actually test myself later, most of that familiarity disappears. I freeze, or I realize I can't recall the information without my notes. It's frustrating because during studying I feel confident, but during the test I feel stuck. I'm beginning to notice that I rarely practice retrieving information — I mostly practice recognizing it. Maybe that's why my grades don't match how prepared I thought I was."</p>
                    </div>

                    <label for="reflectionText">Take a moment to reflect. How does this observation connect to YOUR own experience?</label>
                    <textarea id="reflectionText"
                        placeholder="Write at least 50 words describing how the above observation mirrors or differs from your actual experience. Can you relate to the feeling of 'familiarity' versus actual recall?"></textarea>
                    <p class="meta"><span id="reflectionMeta">0</span> / 50 words minimum</p>
                    <button class="btn btn-primary" id="reflectionContinueBtn" disabled>I've reflected — Continue to Curiosity Question</button>
                </div>
            </section>

            <section id="phase2" class="hidden">
                <div class="card stack">
                    <h2>Phase 2: The Curiosity Question</h2>
                    <p class="explanation-box"><strong>What this phase is about:</strong> This phase transforms a personal observation into structured scientific curiosity.</p>
                    
                    <div class="observation-box" id="curiosityBox">
                        <p><strong>What would happen if I tested myself on the material instead of just reading it over and over?</strong></p>
                    </div>

                    <div class="field">
                        <label>Based on your actual test taking experiences:</label>
                        <div class="radio-group">
                            <label class="checkbox-label">
                                <input type="radio" name="curiosityResponse" value="agree">
                                <span><strong>Agree</strong> - This reflects my experience exactly</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="curiosityResponse" value="disagree">
                                <span><strong>Disagree</strong> - This doesn't match my habits</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="curiosityResponse" value="unsure">
                                <span><strong>Unsure</strong> - I need to think about this more</span>
                            </label>
                        </div>
                    </div>

                    <div class="field">
                        <label for="curiosityExplanation">Briefly explain your choice:</label>
                        <textarea id="curiosityExplanation" placeholder="Why does/doesn't this question resonate with you?"></textarea>
                    </div>

                    <button class="btn btn-primary" id="curiosityContinueBtn" disabled>Continue to Research Question</button>
                </div>
            </section>

            <section id="phase3a" class="hidden">
                <div class="card stack">
                    <h2>Phase 3: Research Foundation (1/3)</h2>
                    <div class="observation-box">
                        <h3>Research Question</h3>
                        <p style="font-weight: 600;">Does retrieval practice (self-testing) produce better long-term retention than repeated rereading?</p>
                    </div>

                    <div class="field">
                        <label for="rqUnderstanding">Rate your understanding of this research question:</label>
                        <select id="rqUnderstanding">
                            <option value="">-- Select your understanding level --</option>
                            <option value="clear">Clear - I understand exactly what's being investigated</option>
                            <option value="somewhat">Somewhat - I have a general idea but some questions</option>
                            <option value="confused">Confused - I'm not sure what's being studied</option>
                        </select>
                    </div>

                    <button class="btn btn-primary" id="rqContinueBtn" disabled>Proceed to Hypothesis →</button>
                </div>
            </section>

            <section id="phase3b" class="hidden">
                <div class="card stack">
                    <h2>Phase 3: Research Foundation (2/3)</h2>
                    
                    <h3>The Hypothesis</h3>
                    <div class="observation-box">
                        <p><strong>Retrieval practice</strong> (IV) produces better <strong>long-term retention</strong> (DV) than repeated rereading when <strong>study time is held constant</strong> (CV).</p>
                    </div>
                    <p class="meta" style="margin-top:0.5rem;"><strong>Why this works:</strong> Because actively recalling information strengthens memory pathways more effectively than passively reviewing material (The Testing Effect).</p>

                    <div class="field" style="margin-top: 1rem; border-top: 1px solid #eee; padding-top: 1rem;">
                        <label>Test Your Understanding: Which statement describes a valid Hypothesis?</label>
                        <div class="radio-group">
                            <label class="checkbox-label">
                                <input type="radio" name="hypothesisFormat" value="prediction_error">
                                <span>"If I study hard, I will get an A."</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="hypothesisFormat" value="correct_answer">
                                <span>"It is a tentative answer to the Research Question proposing a relationship between variables."</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="hypothesisFormat" value="vague_error">
                                <span>"It is a fact found in the textbook."</span>
                            </label>
                        </div>
                    </div>

                    <div class="hypothesis-feedback" id="hypothesisFeedback"></div>
                    <button class="btn btn-primary" id="hypothesisContinueBtn" disabled>Proceed to Your Prediction →</button>
                </div>
            </section>

            <section id="phase3c" class="hidden">
                <div class="card stack">
                    <h2>Phase 3: Research Foundation (3/3) - Prediction</h2>
                    
                    <div class="field">
                        <label for="predictionChoice">Based on the hypothesis, select the prediction strategy that will produce better results?</label>
                        <select id="predictionChoice">
                            <option value="">-- Select your prediction --</option>
                            <option value="retrieval">Retrieval practice (self-testing)</option>
                            <option value="rereading">Repeated rereading</option>
                            <option value="same">They will be about the same</option>
                        </select>
                    </div>

                    <div class="field">
                        <label for="predictionConfidence">How confident are you in this prediction? (1 = guessing, 5 = very confident)</label>
                        <input type="range" id="predictionConfidence" min="1" max="5" value="3">
                        <p class="meta">Confidence: <span id="confValue">3</span>/5</p>
                    </div>

                    <button class="btn btn-primary" id="predictionContinueBtn" disabled>Lock in my prediction →</button>
                </div>
            </section>

            <section id="phase4" class="hidden">
                <div class="card stack">
                    <h2>Phase 4: Experimental Design</h2>
                    
                    <h3>The Original Study: Roediger & Karpicke (2006)</h3>
                    <div class="observation-box">
                        <p>Students studied a prose passage. One group read it four times (massed reading). Another group read it once, then took three practice tests (retrieval practice). Both groups spent equal total time interacting with the material. One week later, all students took a final retention test.</p>
                    </div>

                    <h3>My Personal Experiment Design</h3>
                    <div class="observation-box">
                        <p>I will choose a topic for my next exam. Instead of re-reading my notes, I will force myself to write down everything I know about the topic on a blank sheet of paper (Free Recall), then check my notes to correct errors. I will repeat this process until I can recall the information perfectly without looking.</p>
                    </div>
                    
                    <button class="btn btn-primary" id="designContinueBtn">Show me the results</button>
                </div>
            </section>

            <section id="phase5" class="hidden">
                <div class="card stack">
                    <h2>Phase 5: The Results</h2>
                    <p class="explanation-box">Here is what happened in the original study.</p>

                    <div class="data-viz-box">
                        <canvas id="resultsChart" style="max-height:250px;"></canvas>
                    </div>

                    <div class="citation-box">
                        <h4>Original Study Details</h4>
                        <p class="meta"><strong>Citation:</strong> Roediger, H. L., & Karpicke, J. D. (2006). Test-enhanced learning: Taking memory tests improves long-term retention. Psychological Science, 17(3), 249-255.</p>
                        <p class="meta"><strong>Result:</strong> Retrieval practice produced significantly better long-term retention than repeated studying (80% vs 40%).</p>
                    </div>

                    <div class="observation-box" style="border-left: 3px solid var(--uwp-green);">
                        <h4>Conclusion</h4>
                        <p><strong>Hypothesis ACCEPTED.</strong> The feeling of fluency from rereading is deceptive; active recall creates more durable learning.</p>
                    </div>

                    <div class="field">
                        <label for="resultsReflection">Your Metacognitive Reflection (Required):</label>
                        <p class="subline">How does this evidence challenge or confirm your current study habits?</p>
                        <textarea id="resultsReflection" placeholder="I was surprised to learn... This matters for my studying because..."></textarea>
                        <p class="meta"><span id="reflectionWordCount">0</span> / 75 words minimum</p>
                    </div>

                    <button class="btn btn-primary" id="resultsContinueBtn" disabled>Continue to Design Your Experiment</button>
                </div>
            </section>

            <section id="phase6" class="hidden">
                <div class="card stack">
                    <h2>Phase 6: Your Personal Experiment</h2>
                    <p class="explanation-box">Commit to applying this strategy in your actual coursework.</p>
                    
                    <div class="field">
                        <label for="expCourse">Which course will you test this in?</label>
                        <input type="text" id="expCourse" placeholder="e.g., Biology 101">
                    </div>
                    <div class="field">
                        <label for="expMaterial">What specific material/topic?</label>
                        <input type="text" id="expMaterial" placeholder="e.g., Cellular Respiration">
                    </div>
                    <div class="field">
                        <label for="expChange">What will you do differently?</label>
                        <textarea id="expChange" placeholder="Instead of rereading, I will..."></textarea>
                    </div>
                    <div class="field">
                        <label for="expMeasure">How will you measure success?</label>
                        <input type="text" id="expMeasure" placeholder="e.g., Quiz score > 85%">
                    </div>
                    <div class="row-flex">
                        <div class="field">
                            <label for="expStart">Start Date</label>
                            <input type="date" id="expStart">
                        </div>
                        <div class="field">
                            <label for="expEval">Evaluation Date</label>
                            <input type="date" id="expEval">
                        </div>
                    </div>
                    <div style="margin: 0.5rem 0;">
                        <label class="checkbox-label">
                            <input type="checkbox" id="expCommit">
                            <strong>I commit to running this experiment</strong>
                        </label>
                    </div>
                    <button class="btn btn-primary" id="commitContinueBtn" disabled>Complete Experiment</button>
                </div>
            </section>

            <section id="phase7" class="hidden">
                <div class="card stack" style="text-align: center; border: 2px solid var(--uwp-green); background: #f0f9f0;">
                    <div style="font-size: 3rem; color: var(--uwp-green);">✓</div>
                    <h2>Experiment Complete!</h2>
                    <p>You have successfully designed an Active Recall strategy.</p>
                    <div class="row-flex" style="justify-content: center; margin-top: 1rem;">
                        <a href="../dashboard.html" class="btn btn-secondary">Return to Dashboard</a>
                        <a href="04-spacing-vs-cramming.html" class="btn btn-primary">Next Experiment →</a>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script src="../assets/js/data.js"></script>
    <script src="../assets/js/logic.js"></script>

    <script>
        // Set the specific ID for this experiment so logic.js knows what to load/save
        const CURRENT_EXPERIMENT_ID = 'activerecallarena';

        // Initialize specific Chart.js config for Active Recall
        function renderSpecificChart() {
            const ctx = document.getElementById('resultsChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Repeated Reading', 'Retrieval Practice'],
                    datasets: [{
                        label: 'Retention (%)',
                        data: [40, 80], // Data from Roediger & Karpicke
                        backgroundColor: ['#cbd5e1', '#016836'],
                        borderColor: ['#4b5563', '#00502f'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: { display: true, text: 'Retention Performance 1 Week Later' },
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true, max: 100, title: { display: true, text: 'Retention (%)' } }
                    }
                }
            });
        }

        // Hook into the logic.js initialization
        window.addEventListener('DOMContentLoaded', () => {
            // logic.js function to initialize the state for this specific experiment
            if (typeof initExperiment === 'function') {
                initExperiment(CURRENT_EXPERIMENT_ID);
            }
            
            // Render the chart when the user reaches Phase 5 (handled by logic.js triggers, 
            // but we register the renderer here for when the button is clicked)
            const designBtn = document.getElementById('designContinueBtn');
            if(designBtn) {
                designBtn.addEventListener('click', renderSpecificChart);
            }
        });
    </script>
</body>
</html>
