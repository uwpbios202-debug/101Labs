<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phospholipid Bilayer â€” Structure Before Function</title>

<!-- Navigation CSS -->
<style>
/* BIOS101 Navigation Bar */
.bios-nav {
  position: sticky;
  top: 0;
  z-index: 1000;
  background: #016836;
  border-bottom: 2px solid #FFD100;
}
.bios-nav-inner {
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 4px 8px;
}
.bios-home {
  color: white;
  font-weight: 700;
  text-decoration: none;
  letter-spacing: .5px;
  padding: 8px 12px;
}
.bios-toggle {
  display: none;
  background: none;
  border: none;
  color: white;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 8px;
}
.bios-menus {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
  flex: 1;
}
.bios-menu { 
  position: relative; 
}
.bios-trigger {
  background: none;
  border: none;
  color: white;
  font-weight: 600;
  cursor: pointer;
  padding: 8px 12px;
  border-radius: 4px;
  transition: background 0.2s;
}
.bios-trigger:hover,
.bios-trigger.active {
  background: rgba(255, 255, 255, 0.1);
}
.bios-trigger.active {
  border-bottom: 2px solid #FFD100;
}
.bios-dropdown {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  background: white;
  border: 1px solid #ccc;
  min-width: 160px;
  z-index: 1001;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.bios-dropdown a {
  display: block;
  padding: 8px 12px;
  color: #212721;
  text-decoration: none;
  transition: background 0.2s;
}
.bios-dropdown a:hover {
  background: #EFECE2;
}
.bios-menu:hover .bios-dropdown,
.bios-menu:focus-within .bios-dropdown {
  display: block;
}
@media (max-width: 768px) {
  .bios-toggle { 
    display: block; 
    margin-left: auto;
  }
  .bios-menus {
    display: none;
    flex-direction: column;
    background: #016836;
    width: 100%;
    position: absolute;
    top: 100%;
    left: 0;
    padding: 8px;
  }
  .bios-menus.open { 
    display: flex; 
  }
  .bios-dropdown {
    position: static;
    border: none;
    box-shadow: none;
    background: rgba(0,0,0,0.1);
  }
}
</style>

<!-- Main Styling - Reduced spacing -->
<style>
/* ===============================
   UWâ€“Parksideâ€“Aligned Styling
   =============================== */

:root {
  --uwp-green: #016836;
  --uwp-gold: #FFD100;
  --uwp-gray: #212721;
  --uwp-light: #EFECE2;
  --uwp-blue: #005B94;
  --uwp-red: #C40027;
}

body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
  padding: 0;
  color: var(--uwp-gray);
  background: white;
  line-height: 1.5; /* Reduced from 1.6 */
}

main {
  max-width: 1000px; /* Reduced from 1100px */
  margin: 0 auto;
  padding: 1rem; /* Reduced from 1.5rem */
}

section {
  margin-bottom: 1.5rem; /* Reduced from 2.5rem */
  padding-bottom: 1rem; /* Added for better separation */
}

h2 {
  color: var(--uwp-green);
  border-left: 4px solid var(--uwp-gold); /* Reduced from 6px */
  padding-left: 0.5rem; /* Reduced from 0.6rem */
  margin-top: 0;
  margin-bottom: 0.75rem;
  font-size: 1.4rem;
}

h3 {
  color: var(--uwp-blue);
  margin: 0.75rem 0;
  font-size: 1.2rem;
}

p {
  margin: 0.5rem 0;
}

figure {
  margin: 0.75rem auto; /* Reduced from 1.2rem */
  max-width: 500px;
}

figure img {
  width: 100%;
  height: auto;
  border: 1px solid #ccc;
  border-radius: 3px;
}

figcaption {
  font-size: 0.85rem;
  background: var(--uwp-light);
  padding: 0.4rem; /* Reduced from 0.5rem */
  margin-top: 0.25rem;
  border-radius: 0 0 3px 3px;
}

.callout {
  background: var(--uwp-light);
  padding: 0.75rem; /* Reduced from 1rem */
  border-left: 4px solid var(--uwp-gold); /* Reduced from 6px */
  border-radius: 3px;
  margin: 0.75rem 0; /* Reduced from 1.5rem */
}

/* Audio Terms - More compact */
.audio-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 0.5rem;
  margin: 0.75rem 0;
}

.audio-term {
  background: #f8f9fa;
  padding: 0.6rem;
  border-radius: 4px;
  border: 1px solid #dee2e6;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.audio-term strong {
  color: var(--uwp-blue);
}

.audio-term button {
  background: var(--uwp-green);
  color: white;
  border: none;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  cursor: pointer;
  font-size: 1rem;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  flex-shrink: 0;
}

.audio-term button:hover {
  background: #014d2d;
  transform: scale(1.1);
}

.audio-term button.playing {
  background: var(--uwp-red);
}

/* Interactive Activities - More compact */
.activity {
  background: #f8fafc;
  border: 2px solid var(--uwp-blue);
  border-radius: 6px;
  padding: 1rem; /* Reduced from 1.5rem */
  margin: 1rem 0; /* Reduced from 2rem */
}

.activity-header {
  display: flex;
  align-items: center;
  margin-bottom: 0.75rem; /* Reduced from 1.5rem */
  padding-bottom: 0.5rem;
  border-bottom: 1px dashed #cbd5e1;
}

.activity-icon {
  background: var(--uwp-blue);
  color: white;
  width: 32px; /* Reduced from 40px */
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 0.75rem;
  flex-shrink: 0;
  font-size: 0.9rem;
}

.activity-title {
  color: var(--uwp-blue);
  margin: 0;
  font-size: 1.1rem;
}

/* Scenarios */
.scenario {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 4px;
  padding: 1rem; /* Reduced from 1.5rem */
  margin: 0.75rem 0; /* Reduced from 1.5rem */
}

.scenario h4 {
  color: var(--uwp-green);
  margin: 0 0 0.5rem 0;
  display: flex;
  align-items: center;
  font-size: 1rem;
}

.scenario-number {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--uwp-gold);
  color: var(--uwp-gray);
  width: 22px; /* Reduced from 24px */
  height: 22px;
  border-radius: 50%;
  margin-right: 0.5rem;
  font-size: 0.8rem;
  font-weight: bold;
}

/* Options - More compact */
.options {
  display: grid;
  gap: 0.5rem; /* Reduced from 1rem */
  margin: 0.75rem 0; /* Reduced from 1.5rem */
}

.option {
  background: #f8fafc;
  border: 1px solid #cbd5e1;
  border-radius: 3px;
  padding: 0.6rem; /* Reduced from 1rem */
  cursor: pointer;
  transition: all 0.2s;
}

.option:hover {
  background: #e2e8f0;
  border-color: var(--uwp-blue);
}

.option.selected {
  background: #e0f2fe;
  border-color: var(--uwp-blue);
  border-width: 2px;
}

.option.correct {
  background: #d1fae5;
  border-color: #10b981;
}

.option.incorrect {
  background: #fee2e2;
  border-color: #ef4444;
}

/* Progress indicator - More compact */
.progress {
  display: flex;
  justify-content: space-between;
  margin: 1rem 0; /* Reduced from 2rem */
  position: relative;
}

.progress-step {
  width: 26px; /* Reduced from 30px */
  height: 26px;
  border-radius: 50%;
  background: #e2e8f0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  position: relative;
  z-index: 1;
  font-size: 0.8rem;
}

.progress-step.active {
  background: var(--uwp-blue);
  color: white;
}

.progress-step.completed {
  background: var(--uwp-green);
  color: white;
}

.progress-line {
  position: absolute;
  top: 13px; /* Adjusted */
  left: 13px;
  right: 13px;
  height: 2px;
  background: #e2e8f0;
  z-index: 0;
}

.progress-line.fill {
  background: var(--uwp-green);
}

/* Buttons - More consistent */
.button {
  background: var(--uwp-green);
  color: white;
  border: none;
  padding: 0.5rem 1rem; /* Reduced from 0.75rem 1.5rem */
  border-radius: 3px;
  cursor: pointer;
  font-weight: bold;
  transition: background 0.2s;
  margin: 0.25rem;
  font-size: 0.9rem;
}

.button:hover {
  background: #014d2d;
}

.button.secondary {
  background: var(--uwp-blue);
}

.button.secondary:hover {
  background: #004a7a;
}

/* Metacognitive enhancements */
.metacognitive-prompt {
  background: #fefce8;
  border: 1px solid #fde047;
  border-radius: 4px;
  padding: 0.75rem;
  margin: 0.75rem 0;
  font-style: italic;
}

.encoding-challenge {
  background: #f0f9ff;
  border: 1px solid #7dd3fc;
  border-radius: 4px;
  padding: 0.75rem;
  margin: 0.75rem 0;
}

.encoding-challenge h5 {
  color: var(--uwp-blue);
  margin: 0 0 0.5rem 0;
  font-size: 0.95rem;
}

.reflection {
  background: #f8fafc;
  border: 1px solid #cbd5e1;
  border-radius: 4px;
  padding: 0.75rem;
  margin: 0.75rem 0;
}

.reflection textarea {
  width: 100%;
  min-height: 60px; /* Reduced from 100px */
  padding: 0.5rem;
  border: 1px solid #cbd5e1;
  border-radius: 3px;
  font-family: inherit;
  font-size: 0.9rem;
  margin-top: 0.5rem;
}

/* Lists - More compact */
ul, ol {
  margin: 0.5rem 0;
  padding-left: 1.2rem;
}

li {
  margin: 0.25rem 0;
}

/* Details - More compact */
details {
  background: #f9f9f9;
  padding: 0.5rem; /* Reduced from 0.8rem */
  border: 1px solid #ccc;
  border-radius: 3px;
  margin: 0.75rem 0;
}

summary {
  font-weight: bold;
  cursor: pointer;
  padding: 0.25rem 0;
}

/* Video container */
.video-container {
  margin: 0.75rem 0;
  position: relative;
  padding-bottom: 56.25%; /* 16:9 */
  height: 0;
}

.video-container iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 4px;
}

/* Footer */
footer {
  margin-top: 2rem; /* Reduced from 3rem */
  padding: 1rem; /* Reduced from 1.5rem */
  font-size: 0.8rem;
  background: var(--uwp-light);
  text-align: center;
  border-top: 1px solid #dee2e6;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  main {
    padding: 0.75rem;
  }
  
  .activity {
    padding: 0.75rem;
  }
  
  .audio-grid {
    grid-template-columns: 1fr;
  }
  
  h2 {
    font-size: 1.2rem;
  }
  
  h3 {
    font-size: 1.1rem;
  }
}
</style>
</head>

<body>

<!-- Navigation Bar -->
<nav class="bios-nav">
  <div class="bios-nav-inner">
    <a href="../index.html" class="bios-home">BIOS101</a>
    <button class="bios-toggle" aria-label="Toggle menu">â˜°</button>
    <div class="bios-menus" id="biosMenus">
      <!-- Navigation will be populated by JavaScript -->
    </div>
  </div>
</nav>

<main>

<!-- 1. ORIENTATION - More metacognitive -->
<section>
  <h2>Why This Matters: Boundary = Life</h2>
  <p>
    Every living cell's survival depends on a <strong>selective boundary</strong> that separates 
    <em>inside</em> from <em>outside</em>. The phospholipid bilayer is that boundary.
  </p>
  
  <div class="metacognitive-prompt">
    <strong>Encoding Challenge:</strong> Close your eyes for 10 seconds. Visualize a cell without a boundary. 
    What disappears firstâ€”its shape, its molecules, or its function?
  </div>
  
  <p>
    Understanding this structure isn't about memorizing partsâ€”it's about recognizing
    how molecular <strong>preferences</strong> create order, stability, and life itself.
  </p>
</section>

<!-- 2. PRIOR KNOWLEDGE - Enhanced with metacognition -->
<section>
  <h2>Before You Learn: Activate Your Thinking</h2>
  <div class="encoding-challenge">
    <h5>Personal Experience Connection</h5>
    <p><strong>Recall:</strong> Have you ever mixed oil and water? What did you observe and why?</p>
    <textarea placeholder="Write your observation here... (e.g., 'Oil formed droplets because...')"></textarea>
  </div>
  
  <ul>
    <li>Why does a cell need a boundary instead of freely mixing with its environment?</li>
    <li>What would be the immediate consequence if that boundary dissolved?</li>
    <li><strong>Predict:</strong> Could a boundary form spontaneously without cellular machinery?</li>
  </ul>
  
  <div class="callout">
    <strong>Metacognitive Check:</strong> Rate your prior knowledge: 
    <select id="prior-knowledge">
      <option value="">Select...</option>
      <option value="1">1 - Never heard of membranes</option>
      <option value="2">2 - Vague idea of cell boundaries</option>
      <option value="3">3 - Familiar with basic membrane structure</option>
      <option value="4">4">4 - Understand hydrophobic/hydrophilic concepts</option>
      <option value="5">5 - Could explain bilayer formation</option>
    </select>
  </div>
</section>

<!-- 3. CORE BACKGROUND WITH INTERACTIVE ACTIVITY 1 -->
<section>
  <h2>The Phospholipid: A Molecule With Preferences</h2>
  
  <div class="encoding-challenge">
    <h5>Pre-Viewing Prediction</h5>
    <p>Before seeing the diagram, sketch what you think an "amphipathic molecule" might look like:</p>
    <textarea placeholder="Describe or sketch in words: A molecule that..."></textarea>
  </div>

  <figure>
    <img src="amphipathic.jpg" alt="Diagram showing hydrophilic head and hydrophobic tails of a phospholipid">
    <figcaption>
      <strong>Amphipathic structure:</strong> A water-loving (hydrophilic) head and water-fearing (hydrophobic) tails.
    </figcaption>
  </figure>

  <div class="metacognitive-prompt">
    <strong>Self-Explanation:</strong> Why is this dual nature <em>necessary</em> rather than just interesting? 
    Complete: "If phospholipids weren't amphipathic, then..."
  </div>
</section>

<!-- 4. INTERACTIVE DECISION ACTIVITY -->
<section>
  <div class="activity">
    <div class="activity-header">
      <div class="activity-icon">!</div>
      <h3 class="activity-title">Activity: Molecule Decision Engine</h3>
    </div>
    
    <p><strong>Cognitive Target:</strong> Structure â†’ Behavior Prediction</p>
    
    <div class="progress">
      <div class="progress-step active">1</div>
      <div class="progress-step">2</div>
      <div class="progress-step">3</div>
      <div class="progress-step">4</div>
      <div class="progress-line"></div>
      <div class="progress-line fill" style="width: 0%;"></div>
    </div>
    
    <!-- Scenario 1 -->
    <div class="scenario" id="scenario1">
      <h4><span class="scenario-number">1</span> Water World</h4>
      <p>A phospholipid is placed in <strong>pure water</strong>. Which part "makes the decision" about orientation?</p>
      
      <div class="options">
        <div class="option" data-value="head">The hydrophilic head (seeks water)</div>
        <div class="option" data-value="tail">The hydrophobic tails (avoid water)</div>
        <div class="option" data-value="both">Both equally (compromise position)</div>
        <div class="option" data-value="neither">Neither (random orientation)</div>
      </div>
      
      <div class="reflection" style="display:none;" id="reflect1">
        <p><strong>Metacognitive Layer:</strong> What evidence from daily life supports your answer?</p>
        <textarea placeholder="Example: 'Oil droplets in water show that...'"></textarea>
      </div>
      
      <button class="button" onclick="checkAnswer(1, 'tail')">Submit Answer</button>
    </div>
    
    <!-- More scenarios would follow in the actual implementation -->
  </div>
</section>

<!-- 5. LANGUAGE DECODING - FIXED AUDIO -->
<section>
  <h2>Say the Words, Own the Concepts</h2>
  <p>Click to hear pronunciation and create a personal association:</p>
  
  <div class="audio-grid">
    <div class="audio-term">
      <strong>Phospholipid</strong>
      <button onclick="playAudio('phospholipid', this)">ðŸ”Š</button>
      <audio id="audio-phospholipid" preload="auto">
        <source src="phospholipid.mp3" type="audio/mpeg">
        Audio not supported
      </audio>
    </div>
    
    <div class="audio-term">
      <strong>Amphipathic</strong>
      <button onclick="playAudio('amphipathic', this)">ðŸ”Š</button>
      <audio id="audio-amphipathic" preload="auto">
        <source src="amphipathic.mp3" type="audio/mpeg">
        Audio not supported
      </audio>
    </div>
    
    <div class="audio-term">
      <strong>Hydrophilic</strong>
      <button onclick="playAudio('hydrophilic', this)">ðŸ”Š</button>
      <audio id="audio-hydrophilic" preload="auto">
        <source src="hydrophilic.mp3" type="audio/mpeg">
        Audio not supported
      </audio>
    </div>
    
    <div class="audio-term">
      <strong>Hydrophobic</strong>
      <button onclick="playAudio('hydrophobic', this)">ðŸ”Š</button>
      <audio id="audio-hydrophobic" preload="auto">
        <source src="hydrophobic.mp3" type="audio/mpeg">
        Audio not supported
      </audio>
    </div>
    
    <div class="audio-term">
      <strong>Bilayer</strong>
      <button onclick="playAudio('bilayer', this)">ðŸ”Š</button>
      <audio id="audio-bilayer" preload="auto">
        <source src="bilayer.mp3" type="audio/mpeg">
        Audio not supported
      </audio>
    </div>
  </div>
  
  <div class="encoding-challenge">
    <h5>Personal Association Encoding</h5>
    <p>For each term, create a mental image or analogy:</p>
    <p><em>"Hydrophobic is like me avoiding cold water in the morning..."</em></p>
    <textarea placeholder="Create your own analogies here..."></textarea>
  </div>
</section>

<!-- 6. BILAYER FORMATION - More metacognitive -->
<section>
  <h2>From Molecule to Boundary: Emergent Order</h2>

  <figure>
    <img src="phospholipid.jpg" alt="Phospholipid bilayer with heads outward and tails inward">
    <figcaption>
      <strong>Self-assembly:</strong> No cellular machinery neededâ€”chemistry drives the formation.
    </figcaption>
  </figure>

  <div class="metacognitive-prompt">
    <strong>Prediction Check:</strong> Before reading the steps below, try to sequence them:
    <ol>
      <li>_____ Hydrophilic heads orient toward water</li>
      <li>_____ Bilayer self-assembles</li>
      <li>_____ Hydrophobic tails avoid water</li>
    </ol>
  </div>

  <div class="callout">
    <strong>Key Insight:</strong> The membrane forms because of <em>molecular preferences</em>, 
    not because the cell "decides" to build it. This is <strong>self-assembly</strong>.
  </div>
</section>

<!-- 7. VIDEO WITH GUIDED OBSERVATION -->
<section>
  <h2>Guided Video Observation</h2>
  <p>
    Watch <strong>0:55â€“1:45 only</strong>. Focus on <em>how</em> phospholipids arrange themselves.
    Ignore transport proteins for now.
  </p>

  <div class="video-container">
    <iframe src="https://www.youtube.com/embed/6wGAVxe7cik?start=55"
      title="Phospholipid bilayer video" allowfullscreen></iframe>
  </div>

  <div class="encoding-challenge">
    <h5>Observation â†’ Explanation Encoding</h5>
    <p>Complete this causal chain: "Because phospholipids are amphipathic â†’ ______ â†’ ______ â†’ bilayer forms"</p>
    <textarea placeholder="Fill in the middle steps..."></textarea>
  </div>
</section>

<!-- 8. CHECK UNDERSTANDING - Enhanced -->
<section>
  <h2>Check Your Understanding</h2>

  <details>
    <summary>What would happen if phospholipids were not amphipathic?</summary>
    <div class="reflection">
      <p><strong>Predicted answer:</strong> A stable membrane would not form.</p>
      <p><strong>Deeper consequence:</strong> What specifically about cellular function would fail first?</p>
      <textarea placeholder="Your analysis..."></textarea>
    </div>
  </details>
  
  <div class="metacognitive-prompt">
    <strong>Confidence Calibration:</strong> How confident are you in your answer above?
    <select id="confidence-level">
      <option value="">Select...</option>
      <option value="1">1 - Just guessing</option>
      <option value="2">2 - Somewhat unsure</option>
      <option value="3">3 - Moderately confident</option>
      <option value="4">4">4 - Pretty sure</option>
      <option value="5">5 - Absolutely certain</option>
    </select>
  </div>
</section>

<!-- 9. METACOGNITIVE REFLECTION - Enhanced -->
<section>
  <h2>What Changed in Your Thinking?</h2>
  
  <div class="reflection">
    <p><strong>Before â†’ After Tracking:</strong></p>
    <p>Before this module, I thought membranes were: <br>
    <textarea placeholder="e.g., 'just a container wall'"></textarea></p>
    
    <p>Now I understand they're: <br>
    <textarea placeholder="e.g., 'self-assembled from molecular preferences'"></textarea></p>
  </div>
  
  <ul>
    <li>What's the <strong>most surprising insight</strong> you gained?</li>
    <li>What's still <strong>fuzzy or confusing</strong>?</li>
    <li>What <strong>one question</strong> will you ask in lab?</li>
  </ul>
  
  <div class="encoding-challenge">
    <h5>Transfer Encoding</h5>
    <p>How might this understanding of self-assembly apply to other biological structures?</p>
    <textarea placeholder="Think about viruses, organelles, or protein folding..."></textarea>
  </div>
</section>

<!-- 10. LAB BRIDGE -->
<section>
  <h2>Preparing for Lab</h2>
  <p>
    In lab, membranes appear as <strong>boundaries</strong>â€”not molecules. This model explains 
    <em>why</em> those boundaries exist and <em>why</em> they're reliable.
  </p>
  
  <div class="callout">
    <strong>Lab Prediction:</strong> Based on what you've learned, predict <strong>one observation</strong> 
    you'll make in lab related to membrane behavior:
    <textarea placeholder="e.g., 'I expect to see... because...'"></textarea>
  </div>
</section>

</main>

<footer>
  BIOS 101 â€¢ University of Wisconsinâ€“Parkside â€¢ Structure Before Function Series
</footer>

<!-- Navigation JavaScript -->
<script>
// BIOS101 Navigation
(function() {
  function initNav() {
    var labs = [
      {folder: "bios101-learning", title: "Metacognition"},
      {folder: "01_Science_of_Biology", title: "Scientific Process"},
      {folder: "02_Eukaryotes", title: "Eukaryotes"},
      {folder: "03_Carbohydrates", title: "Carbohydrates"},
      {folder: "04_Proteins", title: "Proteins"},
      {folder: "05_Lipids", title: "Lipids"},
      {folder: "06_Photosynthetic_Pigments", title: "Photosynthesis"},
      {folder: "07_Nucleic Acids", title: "Nucleic Acids"},
      {folder: "08_Mitosis", title: "Mitosis"},
      {folder: "09_Meiosis", title: "Meiosis"},
      {folder: "10_Genetics", title: "Genetics"}
    ];
    
    var menus = document.getElementById('biosMenus');
    if (!menus) return;
    
    // Get current folder from URL
    var path = window.location.pathname;
    var currentFolder = '';
    
    labs.forEach(function(lab) {
      if (path.indexOf(lab.folder) !== -1) {
        currentFolder = lab.folder;
      }
    });
    
    // Create menu items
    labs.forEach(function(lab) {
      var menu = document.createElement('div');
      menu.className = 'bios-menu';
      
      var trigger = document.createElement('button');
      trigger.className = 'bios-trigger';
      trigger.textContent = lab.title;
      
      // Mark current lab as active
      if (lab.folder === currentFolder) {
        trigger.classList.add('active');
      }
      
      var dropdown = document.createElement('div');
      dropdown.className = 'bios-dropdown';
      
      // Create links
      var links = [
        {name: 'Overview', path: '../' + lab.folder + '/index.html'},
        {name: 'Pre-Lab', path: '../' + lab.folder + '/prelab/prelab.html'},
        {name: 'In-Lab', path: '../' + lab.folder + '/during_lab/in-lab.html'},
        {name: 'Post-Lab', path: '../' + lab.folder + '/postlab/postlab.html'},
        {name: 'Optional', path: '../' + lab.folder + '/advanced/optional.html'}
      ];
      
      links.forEach(function(link) {
        var a = document.createElement('a');
        a.href = link.path;
        a.textContent = link.name;
        dropdown.appendChild(a);
      });
      
      menu.appendChild(trigger);
      menu.appendChild(dropdown);
      menus.appendChild(menu);
    });
    
    // Mobile menu toggle
    var toggle = document.querySelector('.bios-toggle');
    if (toggle) {
      toggle.onclick = function() {
        menus.classList.toggle('open');
      };
    }
  }
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initNav);
  } else {
    initNav();
  }
})();
</script>

<!-- Audio Playback Fix -->
<script>
// Fixed audio playback function
function playAudio(term, button) {
  const audio = document.getElementById(`audio-${term}`);
  if (!audio) {
    console.error(`Audio element for ${term} not found`);
    return;
  }
  
  // Stop all other audios
  document.querySelectorAll('audio').forEach(a => {
    if (a !== audio) {
      a.pause();
      a.currentTime = 0;
    }
  });
  
  // Reset all buttons
  document.querySelectorAll('.audio-term button').forEach(btn => {
    btn.classList.remove('playing');
    btn.innerHTML = 'ðŸ”Š';
  });
  
  if (audio.paused) {
    audio.play()
      .then(() => {
        button.classList.add('playing');
        button.innerHTML = 'â¸';
      })
      .catch(error => {
        console.error('Audio playback failed:', error);
        alert('Audio playback failed. Please check if the audio file exists.');
      });
  } else {
    audio.pause();
    audio.currentTime = 0;
    button.classList.remove('playing');
    button.innerHTML = 'ðŸ”Š';
  }
  
  // Update button when audio ends
  audio.onended = function() {
    button.classList.remove('playing');
    button.innerHTML = 'ðŸ”Š';
  };
}
</script>

<!-- Interactive Activity Script -->
<script>
let currentActivityStep = 1;

function checkAnswer(step, correctAnswer) {
  const scenario = document.getElementById(`scenario${step}`);
  const selected = scenario.querySelector('.option.selected');
  const feedback = document.createElement('div');
  
  if (!selected) {
    feedback.className = 'callout';
    feedback.innerHTML = '<strong>Please select an answer first.</strong>';
    scenario.appendChild(feedback);
    return;
  }
  
  const isCorrect = selected.dataset.value === correctAnswer;
  
  if (isCorrect) {
    feedback.className = 'callout';
    feedback.innerHTML = '<strong>âœ“ Correct!</strong> The hydrophobic tails drive the orientation by avoiding water.';
  } else {
    feedback.className = 'callout';
    feedback.innerHTML = '<strong>âœ— Reconsider:</strong> Which part of the molecule has the strongest aversion to water?';
  }
  
  // Remove any existing feedback
  const existingFeedback = scenario.querySelector('.callout');
  if (existingFeedback) existingFeedback.remove();
  
  scenario.appendChild(feedback);
  
  // Show reflection after feedback
  const reflection = document.getElementById(`reflect${step}`);
  if (reflection) {
    reflection.style.display = 'block';
  }
  
  // Update progress
  updateProgress(step, isCorrect);
}

function updateProgress(step, isCorrect) {
  const progressSteps = document.querySelectorAll('.progress-step');
  const progressFill = document.querySelector('.progress-line.fill');
  
  if (isCorrect) {
    progressSteps[step - 1].classList.remove('active');
    progressSteps[step - 1].classList.add('completed');
    
    if (step < progressSteps.length) {
      progressSteps[step].classList.add('active');
    }
    
    progressFill.style.width = `${(step / progressSteps.length) * 100}%`;
  }
}

// Initialize option selection
document.addEventListener('DOMContentLoaded', function() {
  // Setup option selection
  document.querySelectorAll('.option').forEach(option => {
    option.addEventListener('click', function() {
      // Clear previous selections in this question group
      const parent = this.closest('.scenario') || this.closest('.options').parentElement;
      parent.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected');
      });
      
      // Select this option
      this.classList.add('selected');
    });
  });
  
  // Setup confidence tracking
  const confidenceSelect = document.getElementById('confidence-level');
  if (confidenceSelect) {
    confidenceSelect.addEventListener('change', function() {
      localStorage.setItem('phospholipid-confidence', this.value);
    });
    
    // Load saved confidence
    const savedConfidence = localStorage.getItem('phospholipid-confidence');
    if (savedConfidence) {
      confidenceSelect.value = savedConfidence;
    }
  }
  
  // Setup prior knowledge tracking
  const priorKnowledgeSelect = document.getElementById('prior-knowledge');
  if (priorKnowledgeSelect) {
    priorKnowledgeSelect.addEventListener('change', function() {
      localStorage.setItem('phospholipid-prior-knowledge', this.value);
    });
    
    // Load saved prior knowledge
    const savedPrior = localStorage.getItem('phospholipid-prior-knowledge');
    if (savedPrior) {
      priorKnowledgeSelect.value = savedPrior;
    }
  }
});
</script>

</body>
</html>
