<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diffusion and Osmosis Video Quiz - BIOS101</title>
    <style>
        /* UWP Color Palette */
        :root {
            --uwp-green: #016836;
            --uwp-gold: #FFD100;
            --uwp-white: #FFFFFF;
            --uwp-black: #212721;
            --uwp-gray: #58595B;
            --uwp-light-gray: #EFECE2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            color: var(--uwp-black);
            background-color: var(--uwp-white);
            line-height: 1.6;
        }

        /* Navigation Bar Styles */
        .bios-nav {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: var(--uwp-green);
            border-bottom: 2px solid var(--uwp-gold);
        }

        .bios-nav-inner {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 4px 8px;
        }

        .bios-home {
            color: var(--uwp-white);
            font-weight: 700;
            text-decoration: none;
            letter-spacing: .5px;
            font-size: 1.1rem;
        }

        .bios-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--uwp-white);
            font-size: 1.2rem;
            cursor: pointer;
        }

        .bios-menus {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .bios-menu {
            position: relative;
        }

        .bios-trigger {
            background: none;
            border: none;
            color: var(--uwp-white);
            font-weight: 600;
            cursor: pointer;
            padding: 2px 4px;
            font-size: 0.95rem;
        }

        .bios-trigger.active {
            border-bottom: 2px solid var(--uwp-gold);
        }

        .bios-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--uwp-white);
            border: 1px solid var(--uwp-gray);
            min-width: 160px;
            z-index: 1001;
        }

        .bios-dropdown a {
            display: block;
            padding: 6px 10px;
            color: var(--uwp-black);
            text-decoration: none;
        }

        .bios-dropdown a:hover {
            background: var(--uwp-light-gray);
        }

        .bios-menu:hover .bios-dropdown,
        .bios-menu:focus-within .bios-dropdown {
            display: block;
        }

        /* Main Content */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            color: var(--uwp-green);
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .quiz-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .video-section {
            background: var(--uwp-black);
            padding: 10px;
            border-radius: 4px;
        }

        #youtube-player {
            width: 100%;
            aspect-ratio: 16/9;
        }

        .controls {
            display: flex;
            gap: 6px;
            margin-top: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        button {
            background: var(--uwp-green);
            color: var(--uwp-white);
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            border-radius: 4px;
            transition: background 0.3s;
        }

        button:hover {
            background: #014d28;
        }

        button:disabled {
            background: var(--uwp-gray);
            cursor: not-allowed;
        }

        /* Video control buttons - smaller size */
        .video-control-btn {
            padding: 6px 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .skip-btn {
            padding: 5px 10px;
            font-size: 0.8rem;
            background: var(--uwp-gray);
        }

        .skip-btn:hover {
            background: #404041;
        }

        .question-section {
            background: var(--uwp-light-gray);
            padding: 20px;
            border-radius: 4px;
            border: 2px solid var(--uwp-green);
            min-height: 400px;
        }

        .instructions {
            background: var(--uwp-white);
            padding: 20px;
            border-radius: 4px;
            border: 2px solid var(--uwp-gold);
        }

        .instructions h2 {
            color: var(--uwp-green);
            margin-bottom: 15px;
        }

        .instructions ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .equation-box {
            background: var(--uwp-light-gray);
            padding: 15px;
            border-left: 4px solid var(--uwp-green);
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .equation-prompt {
            font-weight: 600;
            color: var(--uwp-green);
            margin-bottom: 10px;
        }

        .hidden {
            display: none;
        }

        .question-content h3 {
            color: var(--uwp-green);
            margin-bottom: 15px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 15px 0;
        }

        .option-btn {
            background: var(--uwp-white);
            color: var(--uwp-black);
            border: 2px solid var(--uwp-gray);
            padding: 12px;
            text-align: left;
            font-size: 1rem;
        }

        .option-btn:hover {
            background: var(--uwp-light-gray);
            border-color: var(--uwp-green);
        }

        .option-btn.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .option-btn.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .fill-blank-input {
            width: 100%;
            padding: 10px;
            font-size: 1rem;
            border: 2px solid var(--uwp-gray);
            border-radius: 4px;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 4px;
            background: var(--uwp-white);
            border-left: 4px solid var(--uwp-green);
        }

        .score-display {
            background: var(--uwp-white);
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            border: 2px solid var(--uwp-gold);
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--uwp-green);
        }

        .final-results {
            background: var(--uwp-white);
            padding: 30px;
            border-radius: 4px;
            border: 2px solid var(--uwp-green);
            text-align: center;
        }

        .final-results h2 {
            color: var(--uwp-green);
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .final-score {
            font-size: 3rem;
            color: var(--uwp-gold);
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 768px) {
            .bios-toggle {
                display: block;
            }

            .bios-menus {
                display: none;
                flex-direction: column;
                background: var(--uwp-green);
                width: 100%;
            }

            .bios-menus.open {
                display: flex;
            }

            .bios-dropdown {
                position: static;
                border: none;
            }

            .quiz-layout {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="bios-nav">
        <div class="bios-nav-inner">
            <a href="../index.html" class="bios-home">BIOS101</a>
            <button class="bios-toggle" aria-label="Toggle menu">☰</button>
            <div class="bios-menus" id="biosMenus"></div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <h1>Diffusion and Osmosis Video Quiz</h1>

        <div class="quiz-layout">
            <!-- Video Section -->
            <div class="video-section">
                <div id="youtube-player"></div>
                <div class="controls">
                    <button id="playBtn" class="video-control-btn">▶ Play</button>
                    <button id="pauseBtn" class="video-control-btn">⏸ Pause</button>
                    <button id="rewind5Btn" class="skip-btn" title="Rewind 5 seconds">↶ 5s</button>
                    <button id="forward5Btn" class="skip-btn" title="Forward 5 seconds">5s ↷</button>
                    <button id="rewind10Btn" class="skip-btn" title="Rewind 10 seconds">↶ 10s</button>
                    <button id="forward10Btn" class="skip-btn" title="Forward 10 seconds">10s ↷</button>
                    <button id="restartBtn" class="video-control-btn">↻ Restart Quiz</button>
                </div>
            </div>

            <!-- Question/Instructions Section -->
            <div class="question-section">
                <!-- Instructions (shown initially) -->
                <div id="instructions" class="instructions">
                    <h2>How to Use This Quiz</h2>
                    <ul>
                        <li>Questions will appear automatically at specific points in the video</li>
                        <li>The video will pause when a question appears</li>
                        <li>Select your answer and click "Submit Answer"</li>
                        <li>After viewing feedback, click "Continue" to resume the video</li>
                        <li>Your score will be tracked throughout the quiz</li>
                    </ul>

                    <div class="equation-box">
                        <div class="equation-prompt">Before starting, remember this important concept:</div>
                        <div style="font-size: 1.1rem; margin-top: 10px;">
                            <strong>Water follows solute</strong>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.95rem;">
                            Water moves from areas of low solute concentration to areas of high solute concentration
                        </div>
                    </div>

                    <p style="margin-top: 15px; font-weight: 600; color: var(--uwp-green);">
                        Click the Play button above to begin the quiz!
                    </p>
                </div>

                <!-- Question Content (hidden initially) -->
                <div id="questionContent" class="question-content hidden">
                    <h3 id="questionText"></h3>
                    <div id="optionsContainer" class="options"></div>
                    <div id="feedbackContainer" class="feedback hidden"></div>
                    <button id="submitBtn" class="hidden">Submit Answer</button>
                </div>
            </div>
        </div>

        <!-- Score Display -->
        <div id="scoreDisplay" class="score-display hidden">
            Score: <span id="currentScore">0</span> / <span id="totalQuestions">0</span>
        </div>

        <!-- Final Results (hidden initially) -->
        <div id="finalResults" class="final-results hidden">
            <h2>Quiz Complete!</h2>
            <div class="final-score" id="finalScore"></div>
            <p id="finalMessage"></p>
            <button id="retakeBtn" style="margin-top: 20px;">Retake Quiz</button>
        </div>
    </div>

    <!-- Initialize player when page loads -->
    <script>
        // Simulate YouTube API ready callback
        window.onload = function () {
            if (typeof onYouTubeIframeAPIReady === 'function') {
                onYouTubeIframeAPIReady();
            }
        };
    </script>

    <script>
        // Navigation menu data
        const labs = [
            { folder: "bios101-learning", title: "Metacognition" },
            { folder: "01_Science_of_Biology", title: "Scientific Process" },
            { folder: "02_Eukaryotes", title: "Eukaryotes" },
            { folder: "03_Carbohydrates", title: "Carbohydrates" },
            { folder: "04_Proteins", title: "Proteins" },
            { folder: "05_Lipids", title: "Lipids" },
            { folder: "06_Photosynthetic_Pigments", title: "Photosynthesis" },
            { folder: "07_Nucleic Acids", title: "Nucleic Acids" },
            { folder: "08_Mitosis", title: "Mitosis" },
            { folder: "09_Meiosis", title: "Meiosis" },
            { folder: "10_Genetics", title: "Genetics" }
        ];

        // Initialize navigation
        function initNav() {
            const menus = document.getElementById('biosMenus');
            const path = location.pathname;
            if (!menus) return;

            labs.forEach(lab => {
                const menuDiv = document.createElement('div');
                menuDiv.className = 'bios-menu';

                const button = document.createElement('button');
                button.className = 'bios-trigger';
                button.textContent = lab.title;
                if (path.indexOf(lab.folder) !== -1) button.classList.add('active');

                const dropdown = document.createElement('div');
                dropdown.className = 'bios-dropdown';
                const basePath = '../' + lab.folder;
                dropdown.innerHTML = `
                    <a href="${basePath}/index.html">Overview</a>
                    <a href="${basePath}/prelab/prelab.html">Pre-Lab</a>
                    <a href="${basePath}/during_lab/in-lab.html">In-Lab</a>
                    <a href="${basePath}/postlab/postlab.html">Post-Lab</a>
                    <a href="${basePath}/advanced/optional.html">Optional</a>
                `;

                menuDiv.appendChild(button);
                menuDiv.appendChild(dropdown);
                menus.appendChild(menuDiv);
            });

            const toggle = document.querySelector('.bios-toggle');
            if (toggle) {
                toggle.onclick = () => menus.classList.toggle('open');
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initNav);
        } else {
            initNav();
        }

        // Diffusion and Osmosis Quiz Data
        const quizData = [
            {
                number: 1,
                timestamp: "00:00:14.120",
                type: "Fill in the Blank",
                question: "In a solution, salt or sugar acts as the ______, while water acts as the solvent.",
                correctAnswer: "solute",
                points: 1,
                explanation: "The solute (like salt or sugar) is the substance that gets dissolved in the solvent (water).",
                hasTriggered: false
            },
            {
                number: 2,
                timestamp: "00:00:50.920",
                type: "Multiple Choice",
                question: "In the tube experiment, what happened to the blue solution on the right side over time?",
                options: [
                    "The level went down",
                    "The level went up",
                    "The level stayed the same",
                    "The solution turned clear"
                ],
                correctAnswer: "B",
                points: 1,
                explanation: "The level of blue solution on the right went up because water moved toward the higher solute concentration.",
                hasTriggered: false
            },
            {
                number: 3,
                timestamp: "00:01:02.320",
                type: "Multiple Choice",
                question: "What is osmosis?",
                options: [
                    "The movement of solute across a membrane",
                    "The diffusion of water across a semi-permeable membrane",
                    "The breakdown of cell membranes",
                    "The combination of solutions"
                ],
                correctAnswer: "B",
                points: 1,
                explanation: "Osmosis is specifically the diffusion of water across a semi-permeable or selectively permeable membrane.",
                hasTriggered: false
            },
            {
                number: 4,
                timestamp: "00:01:20.640",
                type: "True/False",
                question: "During osmosis, water moves from an area of lower solute concentration to an area of higher solute concentration.",
                options: ["TRUE", "FALSE"],
                correctAnswer: "A",
                points: 1,
                explanation: "Water moves from lower solute concentration (higher water concentration) to higher solute concentration (lower water concentration).",
                hasTriggered: false
            },
            {
                number: 5,
                timestamp: "00:01:41.960",
                type: "Multiple Choice",
                question: "A solution with 1% solute is what percentage water?",
                options: ["1%", "50%", "80%", "99%"],
                correctAnswer: "D",
                points: 1,
                explanation: "If a solution has 1% solute, the remaining 99% is water. Higher solute concentration means lower water concentration.",
                hasTriggered: false
            },
            {
                number: 6,
                timestamp: "00:01:58.840",
                type: "Fill in the Blank",
                question: "The easy way to remember the direction water flows during osmosis is: 'Water follows ______.'",
                correctAnswer: "solute",
                points: 1,
                explanation: "The simple rule is 'water follows solute' - water moves toward areas of higher solute concentration.",
                hasTriggered: false
            },
            {
                number: 7,
                timestamp: "00:02:14.080",
                type: "Multiple Choice",
                question: "What does 'hypertonic' mean?",
                options: [
                    "Lower solute concentration",
                    "Higher solute concentration",
                    "Equal solute concentration",
                    "No solute present"
                ],
                correctAnswer: "B",
                points: 1,
                explanation: "Hypertonic refers to the solution with the higher solute concentration when comparing two solutions.",
                hasTriggered: false
            },
            {
                number: 8,
                timestamp: "00:02:22.599",
                type: "True/False",
                question: "Water will always flow across a membrane toward the hypertonic solution.",
                options: ["TRUE", "FALSE"],
                correctAnswer: "A",
                points: 1,
                explanation: "Water follows solute, so it moves toward the hypertonic (higher solute concentration) solution.",
                hasTriggered: false
            },
            {
                number: 9,
                timestamp: "00:02:30.280",
                type: "Multiple Choice",
                question: "What is a hypotonic solution?",
                options: [
                    "A solution with higher solute concentration",
                    "A solution with lower solute concentration",
                    "A solution with equal solute concentration",
                    "A solution with no water"
                ],
                correctAnswer: "B",
                points: 1,
                explanation: "Hypotonic refers to the solution with the lower solute concentration.",
                hasTriggered: false
            },
            {
                number: 10,
                timestamp: "00:02:50.480",
                type: "Multiple Choice",
                question: "What happens when two solutions are isotonic?",
                options: [
                    "All water moves to one side",
                    "Water movement stops completely",
                    "There is no net change in water amounts",
                    "The membrane breaks down"
                ],
                correctAnswer: "C",
                points: 1,
                explanation: "In isotonic solutions with equal solute concentrations, water moves equally in both directions, resulting in no net change.",
                hasTriggered: false
            },
            {
                number: 11,
                timestamp: "00:03:04.680",
                type: "Multiple Choice",
                question: "When blood cells are placed in a hypotonic solution, what will happen to them?",
                options: [
                    "They will shrink",
                    "They will stay the same",
                    "They will pop/explode",
                    "They will dissolve"
                ],
                correctAnswer: "C",
                points: 1,
                explanation: "In a hypotonic solution, water rushes into the cells by osmosis, causing them to swell and eventually pop.",
                hasTriggered: false
            },
            {
                number: 12,
                timestamp: "00:03:16.519",
                type: "True/False",
                question: "Blood cells in distilled water popped because the cell's cytoplasm had a higher concentration of solute than the water.",
                options: ["TRUE", "FALSE"],
                correctAnswer: "A",
                points: 1,
                explanation: "The cytoplasm's higher solute concentration drew water in by osmosis until the cells burst.",
                hasTriggered: false
            },
            {
                number: 13,
                timestamp: "00:03:31.000",
                type: "Multiple Choice",
                question: "Corn syrup is described as what type of solution?",
                options: [
                    "Hypotonic",
                    "Isotonic",
                    "Hypertonic",
                    "Distilled"
                ],
                correctAnswer: "C",
                points: 1,
                explanation: "Corn syrup is hypertonic because it is very concentrated with sugar (solute).",
                hasTriggered: false
            },
            {
                number: 14,
                timestamp: "00:03:37.280",
                type: "Fill in the Blank",
                question: "Corn syrup is thick because it is very concentrated with ______, a solute.",
                correctAnswer: "sugar",
                points: 1,
                explanation: "The high concentration of sugar makes corn syrup thick and hypertonic.",
                hasTriggered: false
            },
            {
                number: 15,
                timestamp: "00:03:54.640",
                type: "Multiple Choice",
                question: "What happened to the egg when it was soaked in hypertonic corn syrup?",
                options: [
                    "It expanded and popped",
                    "It stayed the same size",
                    "It shrank and shriveled like a raisin",
                    "It dissolved completely"
                ],
                correctAnswer: "C",
                points: 1,
                explanation: "The egg lost water due to osmosis and shrank, becoming shriveled like a raisin.",
                hasTriggered: false
            }
        ];

        // Quiz State
        let player;
        let currentQuestion = null;
        let score = 0;
        let questionsAnswered = 0;
        let userAnswer = null;
        let hasStarted = false;

        // Local Video Player Setup
        function onYouTubeIframeAPIReady() {
            // Using HTML5 video instead of YouTube
            const videoContainer = document.getElementById('youtube-player');
            videoContainer.innerHTML = '<video id="local-video" controls style="width: 100%; aspect-ratio: 16/9;"><source src="PassiveTransport.mp4" type="video/mp4">Your browser does not support the video tag.</video>';

            // Create a player-like object to match YouTube API
            const videoElement = document.getElementById('local-video');
            player = {
                playVideo: () => videoElement.play(),
                pauseVideo: () => videoElement.pause(),
                getCurrentTime: () => videoElement.currentTime,
                getDuration: () => videoElement.duration,
                seekTo: (seconds) => { videoElement.currentTime = seconds; },
                getPlayerState: () => {
                    if (videoElement.ended) return 0; // ENDED
                    if (videoElement.paused) return 2; // PAUSED
                    if (videoElement.readyState < 3) return 3; // BUFFERING
                    return 1; // PLAYING
                }
            };

            // Simulate YouTube player states
            const YT = window.YT || {};
            YT.PlayerState = {
                ENDED: 0,
                PLAYING: 1,
                PAUSED: 2,
                BUFFERING: 3,
                CUED: 5
            };
            window.YT = YT;

            videoElement.addEventListener('loadedmetadata', onPlayerReady);
            videoElement.addEventListener('play', () => onPlayerStateChange({ data: 1 }));
            videoElement.addEventListener('pause', () => onPlayerStateChange({ data: 2 }));
            videoElement.addEventListener('ended', () => onPlayerStateChange({ data: 0 }));
        }
        
        function onPlayerReady(event) {
            document.getElementById('playBtn').addEventListener('click', () => {
                player.playVideo();
                if (!hasStarted) {
                    hasStarted = true;
                    document.getElementById('instructions').classList.add('hidden');
                    document.getElementById('scoreDisplay').classList.remove('hidden');
                    document.getElementById('totalQuestions').textContent = quizData.length;
                }
            });
            document.getElementById('pauseBtn').addEventListener('click', () => player.pauseVideo());
            document.getElementById('restartBtn').addEventListener('click', resetQuiz);

            // Skip buttons
            document.getElementById('rewind5Btn').addEventListener('click', () => {
                const currentTime = player.getCurrentTime();
                player.seekTo(Math.max(0, currentTime - 5));
            });
            document.getElementById('forward5Btn').addEventListener('click', () => {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                player.seekTo(Math.min(duration, currentTime + 5));
            });
            document.getElementById('rewind10Btn').addEventListener('click', () => {
                const currentTime = player.getCurrentTime();
                player.seekTo(Math.max(0, currentTime - 10));
            });
            document.getElementById('forward10Btn').addEventListener('click', () => {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                player.seekTo(Math.min(duration, currentTime + 10));
            });
            
            // Set up submit button
            document.getElementById('submitBtn').addEventListener('click', submitAnswer);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                checkForQuestions();
            }
        }

        // Convert timestamp to seconds
        function timestampToSeconds(timestamp) {
            const parts = timestamp.split(':');
            const hours = parts.length === 3 ? parseInt(parts[0]) : 0;
            const minutes = parts.length === 3 ? parseInt(parts[1]) : parseInt(parts[0]);
            const seconds = parseFloat(parts[parts.length === 3 ? 2 : 1]);
            return hours * 3600 + minutes * 60 + seconds;
        }

        // Check for questions
        function checkForQuestions() {
            const interval = setInterval(() => {
                const playerState = player.getPlayerState();

                // Only clear interval if video is explicitly stopped or ended
                if (playerState === YT.PlayerState.ENDED || playerState === YT.PlayerState.CUED) {
                    clearInterval(interval);
                    return;
                }

                // Skip checking if video is paused or buffering, but don't clear the interval
                if (playerState !== YT.PlayerState.PLAYING) {
                    return;
                }

                const currentTime = player.getCurrentTime();

                for (let question of quizData) {
                    if (!question.hasTriggered) {
                        const triggerTime = timestampToSeconds(question.timestamp);
                        if (currentTime >= triggerTime) {
                            question.hasTriggered = true;
                            showQuestion(question);
                            player.pauseVideo();
                            clearInterval(interval);
                            break;
                        }
                    }
                }
            }, 100);
        }

        // Show question
        function showQuestion(question) {
            currentQuestion = question;
            userAnswer = null;

            // Hide any previous question content first
            document.getElementById('questionContent').classList.add('hidden');

            // Small delay to ensure smooth transition
            setTimeout(() => {
                document.getElementById('questionContent').classList.remove('hidden');
                document.getElementById('questionText').textContent = `Question ${question.number}: ${question.question}`;

                const optionsContainer = document.getElementById('optionsContainer');
                optionsContainer.innerHTML = '';

                if (question.type === 'Fill in the Blank') {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'fill-blank-input';
                    input.id = 'fillBlankInput';
                    input.placeholder = 'Type your answer here...';
                    optionsContainer.appendChild(input);
                } else if (question.type === 'True/False') {
                    // For True/False questions, create buttons for TRUE and FALSE
                    const trueBtn = document.createElement('button');
                    trueBtn.className = 'option-btn';
                    trueBtn.textContent = 'A. TRUE';
                    trueBtn.onclick = () => selectAnswer('A');
                    trueBtn.id = 'optionA';
                    optionsContainer.appendChild(trueBtn);

                    const falseBtn = document.createElement('button');
                    falseBtn.className = 'option-btn';
                    falseBtn.textContent = 'B. FALSE';
                    falseBtn.onclick = () => selectAnswer('B');
                    falseBtn.id = 'optionB';
                    optionsContainer.appendChild(falseBtn);
                } else {
                    // For Multiple Choice questions
                    question.options.forEach((option, index) => {
                        const btn = document.createElement('button');
                        btn.className = 'option-btn';
                        btn.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                        btn.onclick = () => selectAnswer(String.fromCharCode(65 + index));
                        btn.id = `option${String.fromCharCode(65 + index)}`;
                        optionsContainer.appendChild(btn);
                    });
                }

                document.getElementById('submitBtn').classList.remove('hidden');
                document.getElementById('feedbackContainer').classList.add('hidden');
            }, 100);
        }

        // Select answer
        function selectAnswer(answer) {
            userAnswer = answer;
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.style.background = 'var(--uwp-white)';
                btn.style.borderColor = 'var(--uwp-gray)';
            });
            const selectedBtn = document.getElementById(`option${answer}`);
            if (selectedBtn) {
                selectedBtn.style.background = 'var(--uwp-light-gray)';
                selectedBtn.style.borderColor = 'var(--uwp-green)';
            }
        }

        // Submit answer
        function submitAnswer() {
            if (currentQuestion.type === 'Fill in the Blank') {
                userAnswer = document.getElementById('fillBlankInput').value.trim();
                if (!userAnswer) {
                    alert('Please enter an answer!');
                    return;
                }
            } else if (!userAnswer) {
                alert('Please select an answer!');
                return;
            }

            const isCorrect = userAnswer.toUpperCase() === currentQuestion.correctAnswer.toUpperCase();

            if (isCorrect) {
                score += currentQuestion.points;
            }
            questionsAnswered++;

            // Update score display
            document.getElementById('currentScore').textContent = score;

            // Show feedback
            const feedbackContainer = document.getElementById('feedbackContainer');
            feedbackContainer.innerHTML = `
                <strong>${isCorrect ? '✓ Correct!' : '✗ Incorrect'}</strong><br>
                ${currentQuestion.explanation}
            `;
            feedbackContainer.style.borderLeftColor = isCorrect ? '#28a745' : '#dc3545';
            feedbackContainer.classList.remove('hidden');

            // Highlight correct/incorrect answers
            if (currentQuestion.type !== 'Fill in the Blank') {
                document.querySelectorAll('.option-btn').forEach(btn => {
                    btn.disabled = true;
                    const letter = btn.id.replace('option', '');
                    if (letter === currentQuestion.correctAnswer) {
                        btn.classList.add('correct');
                    } else if (letter === userAnswer && !isCorrect) {
                        btn.classList.add('incorrect');
                    }
                });
            }

            document.getElementById('submitBtn').classList.add('hidden');

            // Automatically resume video after 2 seconds
            setTimeout(() => {
                if (questionsAnswered >= quizData.length) {
                    document.getElementById('questionContent').classList.add('hidden');
                    showFinalResults();
                } else {
                    player.playVideo();
                    checkForQuestions();
                }
            }, 2000);
        }

        // Show final results
        function showFinalResults() {
            const percentage = Math.round((score / quizData.length) * 100);
            document.getElementById('finalResults').classList.remove('hidden');
            document.getElementById('finalScore').textContent = `${score} / ${quizData.length} (${percentage}%)`;

            let message = '';
            if (percentage >= 90) {
                message = 'Excellent work! You have a strong understanding of diffusion and osmosis!';
            } else if (percentage >= 80) {
                message = 'Great job! You understand the key concepts of solute movement well.';
            } else if (percentage >= 70) {
                message = 'Good effort! Review the material to strengthen your understanding.';
            } else {
                message = 'Keep studying! Consider rewatching the video and retaking the quiz.';
            }
            document.getElementById('finalMessage').textContent = message;
        }

        // Reset quiz
        function resetQuiz() {
            score = 0;
            questionsAnswered = 0;
            currentQuestion = null;
            userAnswer = null;
            hasStarted = false;

            quizData.forEach(q => q.hasTriggered = false);

            document.getElementById('currentScore').textContent = '0';
            document.getElementById('questionContent').classList.add('hidden');
            document.getElementById('finalResults').classList.add('hidden');
            document.getElementById('scoreDisplay').classList.add('hidden');
            document.getElementById('instructions').classList.remove('hidden');

            player.seekTo(0);
            player.pauseVideo();
        }

        document.getElementById('retakeBtn').addEventListener('click', resetQuiz);
    </script>
</body>

</html>s
