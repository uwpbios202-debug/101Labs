<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oil Immersion Microscope Technique Quiz</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #1a1a2e;
            color: #e6e6e6;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #16213e;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #0f3460 0%, #1a5f7a 100%);
            color: white;
            padding: 15px 30px;
            text-align: center;
            border-bottom: 5px solid #00adb5;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-left {
            flex: 1;
            text-align: left;
        }

        .header-center {
            flex: 2;
            text-align: center;
        }

        .header-right {
            flex: 1;
            text-align: right;
        }

        .back-link {
            color: white;
            text-decoration: none;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .content-wrapper {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
            gap: 20px;
        }

        .video-section {
            flex: 1;
            min-width: 300px;
        }

        .quiz-section {
            flex: 1;
            min-width: 300px;
            background-color: #0f3460;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .video-container {
            position: relative;
            border-radius: 10px;
            margin-bottom: 10px;
            background-color: #000;
            overflow: hidden;
        }

        .video-container video {
            width: 100%;
            height: auto;
            display: block;
        }

        .video-overlay {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
        }

        .youtube-link {
            background-color: #ff0000;
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 50px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .youtube-link:hover {
            background-color: #cc0000;
            transform: translateY(-2px);
        }

        .video-controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin-top: 10px;
            margin-bottom: 15px;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .control-btn {
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            min-width: 70px;
            justify-content: center;
        }

        #play-pause {
            background-color: #4CAF50;
        }

        #play-pause:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        #stop {
            background-color: #f44336;
        }

        #stop:hover {
            background-color: #d32f2f;
            transform: translateY(-2px);
        }

        #back-10,
        #back-5 {
            background-color: #2196F3;
        }

        #back-10:hover,
        #back-5:hover {
            background-color: #1976D2;
            transform: translateY(-2px);
        }

        #forward-5,
        #forward-10 {
            background-color: #FF9800;
        }

        #forward-5:hover,
        #forward-10:hover {
            background-color: #F57C00;
            transform: translateY(-2px);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #00adb5;
        }

        .question-counter {
            font-size: 1.2rem;
            font-weight: 600;
            color: #00adb5;
        }

        .question-points {
            background-color: #1a5f7a;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: #ffffff;
        }

        .options-container {
            margin-bottom: 25px;
        }

        .option {
            background-color: #1a1a2e;
            border: 2px solid #2d4059;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }

        .option:hover {
            background-color: #2d4059;
            border-color: #00adb5;
        }

        .option.selected {
            background-color: #0f3460;
            border-color: #00adb5;
            box-shadow: 0 0 0 2px rgba(0, 173, 181, 0.3);
        }

        .option.correct {
            background-color: #2e7d32;
            border-color: #4caf50;
        }

        .option.incorrect {
            background-color: #c62828;
            border-color: #f44336;
        }

        .option-label {
            display: inline-block;
            width: 36px;
            height: 36px;
            background-color: #2d4059;
            border-radius: 50%;
            text-align: center;
            line-height: 36px;
            margin-right: 15px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
        }

        .fill-in-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid #2d4059;
            border-radius: 8px;
            background-color: #1a1a2e;
            color: white;
            margin-top: 10px;
        }

        .fill-in-input:focus {
            outline: none;
            border-color: #00adb5;
        }

        .feedback-container {
            margin-top: 25px;
            padding: 20px;
            background-color: #1a1a2e;
            border-radius: 8px;
            border-left: 5px solid #00adb5;
            display: none;
        }

        .feedback-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .feedback-title {
            color: #00adb5;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .explanation-text {
            font-style: italic;
            color: #b0b0b0;
        }

        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        .nav-btn {
            background-color: #2d4059;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .nav-btn:hover:not(:disabled) {
            background-color: #00adb5;
            transform: translateY(-3px);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .submit-btn {
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
        }

        .submit-btn:hover:not(:disabled) {
            background-color: #388e3c;
            transform: translateY(-3px);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .progress-bar {
            height: 8px;
            background-color: #2d4059;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background-color: #00adb5;
            width: 0%;
            transition: width 0.5s ease;
        }

        .question-type {
            display: inline-block;
            background-color: #1a5f7a;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .score-display {
            text-align: center;
            margin-top: 20px;
            font-size: 1.3rem;
            color: #00adb5;
            font-weight: 600;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .score-display.show {
            visibility: visible;
            opacity: 1;
        }

        .instructions {
            background-color: #0f3460;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.95rem;
            border-left: 4px solid #00adb5;
        }

        .instructions h3 {
            color: #00adb5;
            margin-bottom: 8px;
            font-size: 1.2rem;
        }

        .instructions ul {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 5px;
        }

        .timestamp-indicator {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9rem;
            z-index: 5;
        }

        .true-false-container {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .true-false-btn {
            flex: 1;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid #2d4059;
            border-radius: 8px;
            background-color: #1a1a2e;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .true-false-btn.selected {
            background-color: #0f3460;
            border-color: #00adb5;
            box-shadow: 0 0 0 2px rgba(0, 173, 181, 0.3);
        }

        .true-false-btn:hover:not(.selected) {
            background-color: #2d4059;
        }

        @media (max-width: 768px) {
            .content-wrapper {
                flex-direction: column;
            }

            h3 {
                font-size: 1.5rem;
            }

            .control-btn {
                padding: 6px 10px;
                font-size: 0.8rem;
                min-width: 60px;
            }

            header {
                flex-direction: column;
                gap: 10px;
            }

            .header-left,
            .header-center,
            .header-right {
                text-align: center;
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <div class="header-left">
                <a href="prelab.html" class="back-link">
                    <i class="fas fa-arrow-left"></i> Back
                </a>
            </div>
            <div class="header-center">
                <h3>Oil Immersion Microscope Technique</h3>
                <p class="subtitle">Proper Use of Immersion Oil - Interactive Video Quiz</p>
            </div>
            <div class="header-right"></div>
        </header>

        <div class="content-wrapper">
            <section class="video-section">
                <div class="video-container">
                    <div class="timestamp-indicator" id="timestamp-indicator">Time: 00:00</div>
                    <div class="video-overlay">
                        <a href="https://www.youtube.com/watch?v=example" target="_blank" class="youtube-link">
                            <i class="fab fa-youtube"></i> YouTube
                        </a>
                    </div>
                    <video id="microscope-video" controls>
                        <source src="oil.mp4" type="video/mp4">
                        Your browser does not support the video element.
                    </video>
                </div>

                <div class="video-controls">
                    <button class="control-btn" id="play-pause">
                        <i class="fas fa-play"></i> Play/Pause
                    </button>
                    <button class="control-btn" id="stop">
                        <i class="fas fa-stop"></i> Stop
                    </button>
                    <button class="control-btn" id="back-10">
                        <i class="fas fa-backward"></i> -10s
                    </button>
                    <button class="control-btn" id="back-5">
                        <i class="fas fa-step-backward"></i> -5s
                    </button>
                    <button class="control-btn" id="forward-5">
                        <i class="fas fa-step-forward"></i> +5s
                    </button>
                    <button class="control-btn" id="forward-10">
                        <i class="fas fa-forward"></i> +10s
                    </button>
                </div>

                <div class="instructions">
                    <h3><i class="fas fa-info-circle"></i> How to Use This Quiz</h3>
                    <ul>
                        <li>Watch the video and answer questions as they appear at specific timestamps</li>
                        <li>The video will automatically pause when a question becomes available</li>
                        <li>Use the video controls to pause, jump forward/backward, or stop the video</li>
                        <li>Answer each question on the right side and submit to see the correct answer</li>
                        <li>Navigate between questions using Previous/Next buttons</li>
                        <li>Your progress and score are tracked automatically</li>
                    </ul>
                </div>

                <div class="progress-bar">
                    <div class="progress" id="quiz-progress"></div>
                </div>

                <div class="score-display" id="score-display">
                    Score: <span id="score">0</span> / <span id="total-points">12</span>
                </div>
            </section>

            <section class="quiz-section">
                <div class="quiz-header">
                    <div class="question-counter">Question <span id="current-question">1</span> of <span
                            id="total-questions">12</span></div>
                    <div class="question-points" id="points-display">1 point</div>
                </div>

                <div id="question-type" class="question-type">Multiple Choice</div>

                <div class="question-text" id="question-text">Loading question...</div>

                <div class="options-container" id="options-container"></div>

                <div id="true-false-container" style="display: none;" class="true-false-container">
                    <button class="true-false-btn" id="true-btn">TRUE</button>
                    <button class="true-false-btn" id="false-btn">FALSE</button>
                </div>

                <div id="fill-in-container" style="display: none;">
                    <input type="text" class="fill-in-input" id="fill-in-answer" placeholder="Type your answer here...">
                </div>

                <button class="submit-btn" id="submit-answer">Submit Answer</button>

                <div class="feedback-container" id="feedback-container">
                    <div class="feedback-title" id="feedback-title"></div>
                    <div class="explanation-text" id="explanation-text"></div>
                </div>

                <div class="quiz-navigation">
                    <button class="nav-btn" id="prev-question" disabled>
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="nav-btn" id="next-question">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Quiz data converted from the Oil.csv file
        const quizData = [
            {
                number: 1,
                timestamp: "00:05:12",
                type: "Multiple Choice",
                question: "Which microscope lens is the ONLY lens allowed to touch immersion oil?",
                options: ["10x objective", "40x objective", "100x objective", "4x objective"],
                correctAnswer: "C",
                points: 1,
                explanation: "Instructor states repeatedly that only the 100x lens may ever contact oil; others would be permanently damaged.",
                hasTriggered: false
            },
            {
                number: 2,
                timestamp: "00:03:31",
                type: "Multiple Choice",
                question: "Which action must students NEVER perform when focusing at 40x or 100x?",
                options: ["Use fine adjustment", "Move the slide", "Adjust diaphragm", "Use coarse adjustment"],
                correctAnswer: "D",
                points: 1,
                explanation: "Instructor specifies that coarse adjustment is prohibited at 40x and 100x because it risks crashing the lens into the slide.",
                hasTriggered: false
            },
            {
                number: 3,
                timestamp: "00:05:15",
                type: "True/False",
                question: "It is acceptable to get oil on the 40x objective lens.",
                options: ["TRUE", "FALSE"],
                correctAnswer: "B",
                points: 1,
                explanation: "Oil on the 40x lens is described as 'very, very bad' and will permanently damage the microscope.",
                hasTriggered: false
            },
            {
                number: 4,
                timestamp: "00:07:10",
                type: "Multiple Choice",
                question: "Why is transitioning from 100x back to 40x prohibited?",
                options: [
                    "It makes the image too dark",
                    "It risks contaminating the 40x lens with oil",
                    "It breaks parfocal alignment",
                    "It damages the condenser"
                ],
                correctAnswer: "B",
                points: 1,
                explanation: "Returning from 100x to 40x causes oil to smear onto the 40x lens, which is prohibited.",
                hasTriggered: false
            },
            {
                number: 5,
                timestamp: "00:05:53",
                type: "Multiple Choice",
                question: "Which of the following is PROHIBITED when adding immersion oil?",
                options: [
                    "Touching the dropper to the slide",
                    "Letting a drop fall without contact",
                    "Using the smallest drop possible",
                    "Centering the specimen before adding oil"
                ],
                correctAnswer: "A",
                points: 1,
                explanation: "Instructor states the dropper must NOT touch the slide; oil should fall freely from above.",
                hasTriggered: false
            },
            {
                number: 6,
                timestamp: "00:02:27",
                type: "Multiple Choice",
                question: "What should students NOT do when first trying to locate the smear?",
                options: [
                    "Start with 10x",
                    "Draw circle during staining",
                    "Skip directly to 100x",
                    "Check condenser height"
                ],
                correctAnswer: "C",
                points: 1,
                explanation: "Students must begin at 10x; skipping directly to 100x prevents locating the smear.",
                hasTriggered: false
            },
            {
                number: 7,
                timestamp: "00:07:01",
                type: "True/False",
                question: "It is acceptable to use coarse adjustment at 100x power.",
                options: ["TRUE", "FALSE"],
                correctAnswer: "B",
                points: 1,
                explanation: "Coarse adjustment at 100x is explicitly forbidden because it can damage the slide or lens.",
                hasTriggered: false
            },
            {
                number: 8,
                timestamp: "00:07:10",
                type: "Fill in the Blank",
                question: "If the specimen cannot be found at 100x, students must return to the ______ objective rather than the 40x.",
                correctAnswer: "10x",
                points: 1,
                explanation: "Students must NEVER return to 40x once oil is applied; they must go back to 10x.",
                hasTriggered: false
            },
            {
                number: 9,
                timestamp: "00:06:20",
                type: "Multiple Choice",
                question: "Which action is PROHIBITED after immersion oil has been placed?",
                options: [
                    "Center the specimen at 40x",
                    "Move the stage",
                    "Rotate between 40x and 100x",
                    "Check condenser height"
                ],
                correctAnswer: "B",
                points: 1,
                explanation: "Once oil is added, the stage must not be moved; exact alignment is required to prevent losing the smear.",
                hasTriggered: false
            },
            {
                number: 10,
                timestamp: "00:02:31",
                type: "Multiple Choice",
                question: "Students should NOT attempt viewing their smear before confirming visibility at which objective?",
                options: ["4x", "10x", "40x", "100x"],
                correctAnswer: "B",
                points: 1,
                explanation: "Instructor states students must FIRST find the smear at 10x before proceeding further.",
                hasTriggered: false
            },
            {
                number: 11,
                timestamp: "00:04:46",
                type: "Fill in the Blank",
                question: "Using 100x without immersion oil results in a blurry image and the ______ color.",
                correctAnswer: "wrong",
                points: 1,
                explanation: "Without oil, refraction changes and the color appears incorrect (pink vs. purple).",
                hasTriggered: false
            },
            {
                number: 12,
                timestamp: "00:05:21",
                type: "Multiple Choice",
                question: "Which behavior is explicitly prohibited because it may damage the microscope?",
                options: [
                    "Getting oil on 40x lens",
                    "Lowering condenser",
                    "Adjusting diaphragm",
                    "Using fine focus at 100x"
                ],
                correctAnswer: "A",
                points: 1,
                explanation: "Oil on the 40x lens is described as permanently damaging the microscope.",
                hasTriggered: false
            }
        ];

        const videoElement = document.getElementById('microscope-video');
        const timestampIndicator = document.getElementById('timestamp-indicator');
        const currentQuestionElement = document.getElementById('current-question');
        const totalQuestionsElement = document.getElementById('total-questions');
        const questionTextElement = document.getElementById('question-text');
        const questionTypeElement = document.getElementById('question-type');
        const optionsContainer = document.getElementById('options-container');
        const trueFalseContainer = document.getElementById('true-false-container');
        const trueButton = document.getElementById('true-btn');
        const falseButton = document.getElementById('false-btn');
        const fillInContainer = document.getElementById('fill-in-container');
        const fillInAnswerElement = document.getElementById('fill-in-answer');
        const submitButton = document.getElementById('submit-answer');
        const feedbackContainer = document.getElementById('feedback-container');
        const feedbackTitleElement = document.getElementById('feedback-title');
        const explanationTextElement = document.getElementById('explanation-text');
        const prevButton = document.getElementById('prev-question');
        const nextButton = document.getElementById('next-question');
        const playPauseButton = document.getElementById('play-pause');
        const stopButton = document.getElementById('stop');
        const back10Button = document.getElementById('back-10');
        const back5Button = document.getElementById('back-5');
        const forward5Button = document.getElementById('forward-5');
        const forward10Button = document.getElementById('forward-10');
        const quizProgressElement = document.getElementById('quiz-progress');
        const scoreDisplayElement = document.getElementById('score-display');
        const scoreElement = document.getElementById('score');
        const totalPointsElement = document.getElementById('total-points');
        const pointsDisplayElement = document.getElementById('points-display');

        let currentQuestionIndex = 0;
        let selectedAnswer = null;
        let userAnswers = new Array(quizData.length).fill(null);
        let score = 0;
        let isPlaying = false;

        function timestampToSeconds(timestamp) {
            const parts = timestamp.split(':');
            return parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function initQuiz() {
            totalQuestionsElement.textContent = quizData.length;
            totalPointsElement.textContent = quizData.length;
            updateQuestion();
            updateProgress();

            videoElement.addEventListener('timeupdate', () => {
                timestampIndicator.textContent = `Time: ${formatTime(videoElement.currentTime)}`;
            });

            videoElement.addEventListener('play', () => {
                isPlaying = true;
                playPauseButton.innerHTML = '<i class="fas fa-pause"></i> Pause';
            });

            videoElement.addEventListener('pause', () => {
                isPlaying = false;
                playPauseButton.innerHTML = '<i class="fas fa-play"></i> Play';
            });

            videoElement.addEventListener('ended', () => {
                isPlaying = false;
                playPauseButton.innerHTML = '<i class="fas fa-play"></i> Play';
            });

            videoElement.addEventListener('seeking', () => {
                quizData.forEach(q => {
                    if (timestampToSeconds(q.timestamp) > videoElement.currentTime) {
                        q.hasTriggered = false;
                    }
                });
            });

            videoElement.addEventListener('timeupdate', checkForQuestionAtTimestamp);
        }

        function checkForQuestionAtTimestamp() {
            const currentTimestamp = videoElement.currentTime;

            for (let i = 0; i < quizData.length; i++) {
                const questionTime = timestampToSeconds(quizData[i].timestamp);

                if (Math.abs(currentTimestamp - questionTime) < 0.5 &&
                    !quizData[i].hasTriggered &&
                    userAnswers[i] === null) {

                    quizData[i].hasTriggered = true;
                    currentQuestionIndex = i;
                    updateQuestion();

                    if (isPlaying) {
                        videoElement.pause();
                    }
                    return;
                }
            }
        }

        function updateQuestion() {
            const question = quizData[currentQuestionIndex];

            currentQuestionElement.textContent = question.number;
            questionTextElement.textContent = question.question;
            questionTypeElement.textContent = question.type;
            pointsDisplayElement.textContent = `${question.points} point${question.points > 1 ? 's' : ''}`;

            selectedAnswer = null;
            feedbackContainer.classList.remove('show');
            fillInContainer.style.display = 'none';
            trueFalseContainer.style.display = 'none';
            fillInAnswerElement.value = '';
            submitButton.disabled = false;
            submitButton.textContent = 'Submit Answer';

            // Reset true/false buttons
            trueButton.classList.remove('selected');
            falseButton.classList.remove('selected');

            if (currentQuestionIndex > 0 || userAnswers[0] !== null) {
                scoreDisplayElement.classList.add('show');
            }

            prevButton.disabled = currentQuestionIndex === 0;
            nextButton.disabled = currentQuestionIndex === quizData.length - 1;

            if (userAnswers[currentQuestionIndex] !== null) {
                if (question.type === 'Fill in the Blank') {
                    fillInAnswerElement.value = userAnswers[currentQuestionIndex];
                } else if (question.type === 'True/False') {
                    selectedAnswer = userAnswers[currentQuestionIndex];
                    if (selectedAnswer === 'A') {
                        trueButton.classList.add('selected');
                    } else if (selectedAnswer === 'B') {
                        falseButton.classList.add('selected');
                    }
                } else {
                    selectedAnswer = userAnswers[currentQuestionIndex];
                }
            }

            if (question.type === 'Fill in the Blank') {
                fillInContainer.style.display = 'block';
                optionsContainer.innerHTML = '';
            } else if (question.type === 'True/False') {
                trueFalseContainer.style.display = 'flex';
                optionsContainer.innerHTML = '';
            } else {
                renderOptions(question);
            }

            if (userAnswers[currentQuestionIndex] !== null) {
                showFeedback();
            }
        }

        function renderOptions(question) {
            optionsContainer.innerHTML = '';
            const optionLabels = ['A', 'B', 'C', 'D'];

            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';

                if (selectedAnswer === optionLabels[index]) {
                    optionElement.classList.add('selected');
                }

                optionElement.innerHTML = `
                    <div class="option-label">${optionLabels[index]}</div>
                    <div class="option-text">${option}</div>
                `;

                optionElement.addEventListener('click', () => {
                    if (userAnswers[currentQuestionIndex] !== null) return;

                    document.querySelectorAll('.option').forEach(opt => {
                        opt.classList.remove('selected');
                    });

                    optionElement.classList.add('selected');
                    selectedAnswer = optionLabels[index];
                });

                optionsContainer.appendChild(optionElement);
            });
        }

        function submitAnswer() {
            const question = quizData[currentQuestionIndex];
            let isCorrect = false;

            if (question.type === 'Fill in the Blank') {
                const userAnswer = fillInAnswerElement.value.trim().toLowerCase();
                selectedAnswer = userAnswer;
                const correctAnswerLower = question.correctAnswer.toLowerCase();
                isCorrect = userAnswer === correctAnswerLower;
                userAnswers[currentQuestionIndex] = userAnswer;
            } else if (question.type === 'True/False') {
                if (!selectedAnswer) {
                    alert('Please select TRUE or FALSE before submitting.');
                    return;
                }

                isCorrect = selectedAnswer === question.correctAnswer;
                userAnswers[currentQuestionIndex] = selectedAnswer;
            } else {
                if (!selectedAnswer) {
                    alert('Please select an answer before submitting.');
                    return;
                }

                isCorrect = selectedAnswer === question.correctAnswer;
                userAnswers[currentQuestionIndex] = selectedAnswer;

                document.querySelectorAll('.option').forEach((option, index) => {
                    const optionLabel = ['A', 'B', 'C', 'D'][index];

                    if (optionLabel === question.correctAnswer) {
                        option.classList.add('correct');
                    } else if (optionLabel === selectedAnswer && selectedAnswer !== question.correctAnswer) {
                        option.classList.add('incorrect');
                    }
                });
            }

            if (isCorrect) {
                score += question.points;
                scoreElement.textContent = score;
            }

            showFeedback(isCorrect);
            submitButton.disabled = true;
            submitButton.textContent = 'Answer Submitted';
            updateProgress();

            setTimeout(() => {
                if (!isPlaying && currentQuestionIndex < quizData.length - 1) {
                    videoElement.play();
                }
            }, 2000);
        }

        function showFeedback(isCorrect) {
            const question = quizData[currentQuestionIndex];

            if (userAnswers[currentQuestionIndex] === null) return;

            feedbackTitleElement.textContent = isCorrect ?
                `Correct! (${question.points} point${question.points > 1 ? 's' : ''} earned)` :
                `Incorrect. The correct answer is: ${getCorrectAnswerText(question)}`;

            explanationTextElement.textContent = question.explanation;
            feedbackContainer.classList.add('show');
        }

        function getCorrectAnswerText(question) {
            if (question.type === 'Fill in the Blank') {
                return question.correctAnswer;
            } else if (question.type === 'True/False') {
                return question.correctAnswer === 'A' ? 'TRUE' : 'FALSE';
            } else {
                const optionLabels = ['A', 'B', 'C', 'D'];
                const correctIndex = optionLabels.indexOf(question.correctAnswer);
                return question.options[correctIndex];
            }
        }

        function updateProgress() {
            const answeredCount = userAnswers.filter(answer => answer !== null).length;
            const progressPercent = (answeredCount / quizData.length) * 100;
            quizProgressElement.style.width = `${progressPercent}%`;
        }

        function nextQuestion() {
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                updateQuestion();
                jumpToTimestamp(quizData[currentQuestionIndex].timestamp);
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                updateQuestion();
                jumpToTimestamp(quizData[currentQuestionIndex].timestamp);
            }
        }

        function jumpToTimestamp(timestamp) {
            const seconds = timestampToSeconds(timestamp);
            videoElement.currentTime = seconds;

            if (!isPlaying) {
                videoElement.play();
            }
        }

        function togglePlayPause() {
            if (isPlaying) {
                videoElement.pause();
            } else {
                videoElement.play();
            }
        }

        function stopVideo() {
            videoElement.pause();
            videoElement.currentTime = 0;
        }

        function seekBackward(seconds) {
            videoElement.currentTime = Math.max(0, videoElement.currentTime - seconds);
        }

        function seekForward(seconds) {
            videoElement.currentTime = Math.min(videoElement.duration, videoElement.currentTime + seconds);
        }

        // Event listeners
        submitButton.addEventListener('click', submitAnswer);
        nextButton.addEventListener('click', nextQuestion);
        prevButton.addEventListener('click', prevQuestion);
        playPauseButton.addEventListener('click', togglePlayPause);
        stopButton.addEventListener('click', stopVideo);
        back10Button.addEventListener('click', () => seekBackward(10));
        back5Button.addEventListener('click', () => seekBackward(5));
        forward5Button.addEventListener('click', () => seekForward(5));
        forward10Button.addEventListener('click', () => seekForward(10));

        fillInAnswerElement.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                submitAnswer();
            }
        });

        trueButton.addEventListener('click', () => {
            if (userAnswers[currentQuestionIndex] !== null) return;
            trueButton.classList.add('selected');
            falseButton.classList.remove('selected');
            selectedAnswer = 'A';
        });

        falseButton.addEventListener('click', () => {
            if (userAnswers[currentQuestionIndex] !== null) return;
            falseButton.classList.add('selected');
            trueButton.classList.remove('selected');
            selectedAnswer = 'B';
        });

        window.addEventListener('DOMContentLoaded', initQuiz);
    </script>
</body>

</html>
